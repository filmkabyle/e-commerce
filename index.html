<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØªØ¬Ø± Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± (DZ Shop) - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø·ÙˆØ±</title>
    <!-- ØªØ¶Ù…ÙŠÙ† Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Ø¥Ø¹Ø¯Ø§Ø¯ Ø®Ø· Cairo -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap');
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #f7f7f9; /* Ø®Ù„ÙÙŠØ© ÙØ§ØªØ­Ø© Ù…ÙˆØ­Ø¯Ø© */
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .btn-primary {
            @apply bg-emerald-600 text-white font-bold rounded-xl transition-all duration-300 hover:bg-emerald-700 active:scale-[0.98];
        }
        .btn-secondary {
             @apply bg-gray-100 text-gray-800 font-bold rounded-xl transition-all duration-300 hover:bg-gray-200 active:scale-[0.98];
        }
    </style>
    <!-- ØªØ¶Ù…ÙŠÙ† Ù…ÙƒØªØ¨Ø§Øª React Ùˆ Babel -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
</head>
<body>

    <div id="root">
        <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ÙŠØ© Ù‚Ø¨Ù„ ØªÙ‡ÙŠØ¦Ø© React -->
        <div class="fixed inset-0 flex items-center justify-center bg-gray-50 z-[500]">
            <svg class="animate-spin h-10 w-10 text-emerald-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <p class="text-gray-600 mr-3 text-lg font-semibold">Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØªØ¬Ø±...</p>
        </div>
    </div>

    <script type="text/babel">
        // =================================================================================
        // ØªÙ… Ø¯Ù…Ø¬ ÙƒØ§Ù…Ù„ ÙƒÙˆØ¯ React ÙˆØ§Ù„Ù…Ù†Ø·Ù‚ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Babel Ù„ØªØ´ØºÙŠÙ„Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ HTML
        // =================================================================================

        const { useState, useEffect, useCallback, useMemo } = React;

        // ğŸš¨ğŸš¨ğŸš¨ --- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª API Google Apps Script (ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„Ùƒ) --- ğŸš¨ğŸš¨ğŸš¨
        // ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ù‡Ø°Ø§ Ù‡Ùˆ Ø±Ø§Ø¨Ø· Ø§Ù„Ù†Ø´Ø± (Deploy) Ø§Ù„ØµØ­ÙŠØ­ Ù„ØªØ·Ø¨ÙŠÙ‚ Apps Script Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ø¨ØµÙ„Ø§Ø­ÙŠØ© "Ø£ÙŠ Ø´Ø®Øµ"
        const GAS_API_URL = 'https://script.google.com/macros/s/AKfycbwiaw6p3DKnwiICFV8YeC_RVcs6b_OLvyL__mVfRu-7eQLJA1BBOWe1w8oI0Z75EW0/exec'; 

        // --- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© (ØªØ¸Ù‡Ø± Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù€ API) ---
        const MOCK_PRODUCTS = [
            { id: 9001, name: "Ù‡Ø§ØªÙ Ø°ÙƒÙŠ 5G Ø¬Ø¯ÙŠØ¯", price: 125000, category: "Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª", images: ["https://placehold.co/400x400/10b981/ffffff?text=Mock+Phone"], rating: 4.8, reviews: 55, isNew: true, shortDesc: "Ø´Ø§Ø´Ø© AMOLED ÙˆÙƒØ§Ù…ÙŠØ±Ø§ 108MP.", description: "Ù‡Ø§ØªÙ Ù‚ÙˆÙŠ Ø¨Ø£Ø¯Ø§Ø¡ Ù…Ù…ØªØ§Ø² ÙˆØ´Ø­Ù† ÙØ§Ø¦Ù‚ Ø§Ù„Ø³Ø±Ø¹Ø©." }, 
            { id: 9002, name: "Ø³Ø§Ø¹Ø© Ø°ÙƒÙŠØ© Ø±ÙŠØ§Ø¶ÙŠØ©", price: 15000, category: "Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª", images: ["https://placehold.co/400x400/ef4444/ffffff?text=Mock+Watch"], rating: 4.5, reviews: 80, isNew: false, shortDesc: "ØªØªØ¨Ø¹ Ø§Ù„Ù„ÙŠØ§Ù‚Ø© Ø§Ù„Ø¨Ø¯Ù†ÙŠØ© ÙˆØ§Ù„Ù‚Ù„Ø¨.", description: "Ø³Ø§Ø¹Ø© Ù…Ù‚Ø§ÙˆÙ…Ø© Ù„Ù„Ù…Ø§Ø¡ Ù…Ø¹ Ø¹Ù…Ø± Ø¨Ø·Ø§Ø±ÙŠØ© Ø·ÙˆÙŠÙ„ ÙˆÙ…Ø³ØªØ´Ø¹Ø± Ù…Ø¹Ø¯Ù„ Ø¶Ø±Ø¨Ø§Øª Ø§Ù„Ù‚Ù„Ø¨."
        }];
        const MOCK_ORDERS = [];

        // === ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª (Lucide Icons) ===
        const Icon = ({ icon, size = 24, className = "" }) => {
            const icons = {
                ShoppingCart: <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4H6zM3 6h18M6 10h12" />,
                X: <path d="M18 6L6 18M6 6l12 12" />,
                Search: <path d="M11 17a6 6 0 1 0 0-12 6 6 0 0 0 0 12zM15 15l4 4" />,
                MapPin: <path d="M12 22s8-4 8-10A8 8 0 1 0 4 12c0 6 8 10 8 10zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z" />,
                Phone: <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.08 2H7v1.73a1 1 0 0 1-1 1A14.2 14.2 0 0 0 4 12a14.2 14.2 0 0 0 6.27 1.77 1 1 0 0 1 1 1V19z" />,
                CheckCircle: <path d="M22 11.08V12a10 10 0 1 1-5.05-8.83M13 3v8h8" />,
                Truck: <path d="M10 17H6a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-4v-5h-4v5zM6 21a2 2 0 1 0 0-4 2 2 0 0 0 0 4zM16 21a2 2 0 1 0 0-4 2 2 0 0 0 0 4z" />,
                Star: <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" />,
                ArrowRight: <path d="M5 12h14M12 5l7 7-7 7" />,
                ShieldCheck: <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10zM9 12l2 2 4-4" />,
                LayoutDashboard: <rect x="3" y="3" width="7" height="9" /><rect x="14" y="3" width="7" height="5" /><rect x="14" y="11" width="7" height="9" /><rect x="3" y="15" width="7" height="5" />,
                Package: <path d="M12.89 1.45l8 4.5A2 2 0 0 1 22 7.7V17a2 2 0 0 1-1.11 1.74l-8 4.5a2 2 0 0 1-1.78 0l-8-4.5A2 2 0 0 1 2 17V7.7a2 2 0 0 1 1.11-1.75l8-4.5a2 2 0 0 1 1.78 0zM12 20.5v-8.5" />,
                ShoppingBag: <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4H6zM3 6h18M16 10a4 4 0 0 0-8 0" />,
                Plus: <path d="M12 5v14M5 12h14" />,
                Minus: <path d="M5 12h14" />,
                Trash2: <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2M10 11v6M14 11v6" />,
                LogOut: <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4m7 14l5-5-5-5M21 12H9" />,
                DollarSign: <line x1="12" y1="1" x2="12" y2="23" /><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />,
                Loader2: <path d="M21 12a9 9 0 1 1-6.219-8.56" />,
                AlertCircle: <circle cx="12" cy="12" r="10" /><line x1="12" y1="8" x2="12" y2="12" /><line x1="12" y1="16" x2="12" y2="16" />,
                Filter: <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3" />,
                SortAsc: <path d="M17 19H5M17 5L20 8M17 5L14 8M17 5V19" />
            };

            const path = icons[icon];
            if (!path) return <span style={{ width: size, height: size }}>{icon}</span>;
            return (
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width={size}
                    height={size}
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    strokeWidth="2"
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    className={className}
                >
                    {path}
                </svg>
            );
        };

        const WILAYAS = [
            "01 - Ø£Ø¯Ø±Ø§Ø±", "02 - Ø§Ù„Ø´Ù„Ù", "09 - Ø§Ù„Ø¨Ù„ÙŠØ¯Ø©", "16 - Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±", "25 - Ù‚Ø³Ù†Ø·ÙŠÙ†Ø©", "31 - ÙˆÙ‡Ø±Ø§Ù†", 
            "34 - Ø¨Ø±Ø¬ Ø¨ÙˆØ¹Ø±ÙŠØ±ÙŠØ¬", "35 - Ø¨ÙˆÙ…Ø±Ø¯Ø§Ø³", "42 - ØªÙŠØ¨Ø§Ø²Ø©", "44 - Ø¹ÙŠÙ† Ø§Ù„Ø¯ÙÙ„Ù‰", "58 - Ø§Ù„Ù…Ù†ÙŠØ¹Ø©"
        ].sort(); // Ù‚Ø§Ø¦Ù…Ø© Ù…Ø®ØªØµØ±Ø© ÙˆÙˆÙ„Ø§ÙŠØ§Øª Ù…Ø¹Ø±ÙˆÙØ©

        const PRODUCT_CATEGORIES = ['ÙƒÙ„ Ø§Ù„ÙØ¦Ø§Øª', 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª', 'Ù…Ù„Ø§Ø¨Ø³', 'Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª', 'Ø¹Ù†Ø§ÙŠØ© Ø´Ø®ØµÙŠØ©', 'Ù…Ù†Ø²Ù„ ÙˆÙ…Ø·Ø¨Ø®'];

        /**
         * Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¹Ø±Ø¶ Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø³ÙŠØ· Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† alert()
         */
        const showNotification = (message, type = 'green') => {
            const box = document.getElementById('message-box');
            if (!box) return;

            const baseClasses = "text-white p-3 rounded-xl fixed bottom-5 left-1/2 -translate-x-1/2 shadow-xl z-[300] font-bold text-sm transition-opacity duration-300";
            let colorClasses;
            switch (type) {
                case 'red': colorClasses = 'bg-red-600'; break;
                case 'yellow': colorClasses = 'bg-yellow-600'; break;
                case 'green':
                default: colorClasses = 'bg-green-600'; break;
            }

            // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ø¥Ø´Ø¹Ø§Ø± Ø³Ø§Ø¨Ù‚ ÙˆØ¶Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯
            box.innerHTML = `<div class="${baseClasses} ${colorClasses} opacity-0">${message}</div>`;
            const newToast = box.firstChild;
            setTimeout(() => newToast.classList.remove('opacity-0'), 10); // Fade in

            setTimeout(() => {
                newToast.classList.add('opacity-0'); // Fade out
                setTimeout(() => box.innerHTML = '', 300); // Remove after fade out
            }, 5000);
        };

        // --- Ø§Ù„Ù…ÙƒÙˆÙ† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ---
        const App = () => {
            // --- Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù… (State) ---
            const [products, setProducts] = useState([]);
            const [orders, setOrders] = useState([]);
            const [view, setView] = useState('home');
            const [cart, setCart] = useState([]);
            const [isCartOpen, setIsCartOpen] = useState(false);
            const [selectedProduct, setSelectedProduct] = useState(null);
            const [isLoading, setIsLoading] = useState(true); // Ø§Ø¨Ø¯Ø£ Ø¯Ø§Ø¦Ù…Ù‹Ø§ Ø¨Ø§Ù„ØªØ­Ù…ÙŠÙ„
            const [errorMsg, setErrorMsg] = useState(null);

            // Product Filtering/Sorting State
            const [searchTerm, setSearchTerm] = useState('');
            const [filterCategory, setFilterCategory] = useState('ÙƒÙ„ Ø§Ù„ÙØ¦Ø§Øª');
            const [sortBy, setSortBy] = useState('newest'); // 'price_asc', 'price_desc', 'newest'

            // Admin State
            const [isAdminAuthenticated, setIsAdminAuthenticated] = useState(false);
            const [adminPass, setAdminPass] = useState('');
            const [adminTab, setAdminTab] = useState('dashboard');
            const [newProduct, setNewProduct] = useState({
                name: '', price: '', category: 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª', images: '', shortDesc: '', description: ''
            });

            // Checkout State
            const [formData, setFormData] = useState({
                fullName: '', phone: '', wilaya: WILAYAS[0] || '', commune: '', address: ''
            });
            
            // --- Ø¯ÙˆØ§Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Google Sheets API ---
            const fetchData = useCallback(async (sheetName) => {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø±Ø§Ø¨Ø· Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡
                if (!GAS_API_URL || GAS_API_URL.includes('YOUR_GAS_WEB_APP_URL')) {
                    throw new Error("ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ GAS_API_URL Ø§Ù„ØµØ­ÙŠØ­ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯.");
                }
                
                const maxRetries = 3;
                for (let attempt = 0; attempt < maxRetries; attempt++) {
                    try {
                        const response = await fetch(`${GAS_API_URL}?sheet=${sheetName}`);
                        if (!response.ok) throw new Error(`HTTP Error! Status: ${response.status}`);
                        return await response.json();
                    } catch (error) {
                        console.error(`Fetch Error for ${sheetName} attempt ${attempt + 1}:`, error);
                        if (attempt === maxRetries - 1) {
                            throw new Error(`ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª ${sheetName} Ø¨Ø¹Ø¯ ${maxRetries} Ù…Ø­Ø§ÙˆÙ„Ø§Øª: ${error.message}`);
                        }
                        await new Promise(resolve => setTimeout(resolve, Math.pow(2, attempt) * 1000));
                    }
                }
                return []; 
            }, []);

            const sendData = async (action, data) => {
                if (!GAS_API_URL || GAS_API_URL.includes('YOUR_GAS_WEB_APP_URL')) {
                    showNotification("Ø®Ø·Ø£: ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯ GAS_API_URL Ø§Ù„ØµØ­ÙŠØ­.", 'red');
                    return { success: false };
                }
                
                setIsLoading(true);
                try {
                    const response = await fetch(GAS_API_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ action, data }),
                    });
                    const result = await response.json();
                    if (!result.success) throw new Error(result.error || 'ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©');
                    return result;
                } catch (error) {
                    showNotification(`ÙØ´Ù„ ÙÙŠ ØªÙ†ÙÙŠØ° Ø§Ù„Ø¹Ù…Ù„ÙŠØ©: ${error.message}. ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Apps Script.`, 'red');
                    return { success: false };
                } finally {
                    setIsLoading(false);
                }
            };
            
            // Ø¯ÙˆØ§Ù„ Ø¥Ø¶Ø§ÙØ©/Ø­Ø°Ù/ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø·Ù„Ø¨Ø§Øª (Admin Functions)
            const addProduct = async () => {
                // ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
                if (!newProduct.name || !newProduct.price || !newProduct.shortDesc) {
                    showNotification("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.", 'yellow');
                    return;
                }
                if (isNaN(Number(newProduct.price))) {
                    showNotification("Ø§Ù„Ø³Ø¹Ø± ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø±Ù‚Ù…Ø§Ù‹.", 'yellow');
                    return;
                }

                // ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¥Ø±Ø³Ø§Ù„
                const productData = {
                    ...newProduct,
                    price: Number(newProduct.price),
                    images: newProduct.images.split('|').map(url => url.trim()).join('|'),
                    id: Date.now() 
                };

                const result = await sendData('addProduct', productData);

                if (result.success) {
                    // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©
                    setProducts(prev => [...prev, {
                        ...productData,
                        images: productData.images.split('|').filter(url => url), // ØªØ­ÙˆÙŠÙ„ Ù„Ù€ Array ÙÙŠ Ø§Ù„Ù€ State
                        rating: 5.0,
                        reviews: 0,
                        isNew: true
                    }]);
                    setNewProduct({
                        name: '', price: '', category: 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª', images: '', shortDesc: '', description: ''
                    });
                    showNotification('ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­!', 'green');
                }
            };
            
            const deleteProduct = async (id) => {
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… ShowNotification Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† window.confirm
                if (!window.confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ")) return;

                const result = await sendData('deleteProduct', { id });
                if (result.success) {
                    setProducts(prev => prev.filter(p => p.id !== id));
                    showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­.', 'green');
                }
            };

            const updateOrderStatus = async (orderId, newStatus) => {
                const result = await sendData('updateOrderStatus', { id: orderId, status: newStatus });
                if (result.success) {
                    setOrders(prev => prev.map(o => 
                        o.id === orderId ? { ...o, status: newStatus } : o
                    ));
                    showNotification(`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ #${orderId.toString().slice(-6)} Ø¥Ù„Ù‰ ${newStatus}`, 'green');
                }
            };

            const placeOrder = async (e) => {
                e.preventDefault();
                if (cart.length === 0) {
                    showNotification('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©!', 'red');
                    return;
                }

                const itemsToSend = cart.map(item => ({
                    id: item.id,
                    name: item.name,
                    qty: item.qty,
                    price: item.price
                }));

                const total = cart.reduce((a,c) => a + (c.price*c.qty),0) + getShippingCost(formData.wilaya);

                const orderData = {
                    date: new Date().toLocaleDateString('ar-DZ'),
                    total: total,
                    status: 'pending',
                    items: itemsToSend,
                    customer: formData,
                };
                
                const result = await sendData('placeOrder', orderData);

                if (result.success) {
                    setOrders(prev => [{...orderData, id: result.newId || Date.now(), items: itemsToSend, customer: formData}, ...prev]);
                    clearCart();
                    setView('success');
                }
            };

            const handleAdminLogin = (e) => {
                e.preventDefault();
                // ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¨Ø³ÙŠØ·Ø© Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„ØªØ¬Ø±Ø¨Ø©
                if (adminPass === '1234') { 
                    setIsAdminAuthenticated(true);
                    setView('admin-dashboard');
                } else {
                    showNotification('ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©.', 'red');
                    setAdminPass('');
                }
            };

            // --- Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„ ---
            const loadInitialData = useCallback(async () => {
                setIsLoading(true);
                setErrorMsg(null);
                
                try {
                    const [fetchedProducts, fetchedOrders] = await Promise.all([
                        fetchData('Products'),
                        fetchData('Orders')
                    ]);

                    // ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                    setProducts(fetchedProducts.map(p => ({
                        ...p, 
                        id: Number(p.id),
                        price: Number(p.price),
                        rating: Number(p.rating || 5.0),
                        reviews: Number(p.reviews || 0),
                        // ØªØ­ÙˆÙŠÙ„ Ø­Ù‚Ù„ images Ø¥Ù„Ù‰ Ù…ØµÙÙˆÙØ© Ù…Ù† Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
                        images: (p.images && typeof p.images === 'string') ? p.images.split('|').map(url => url.trim()).filter(url => url) : (Array.isArray(p.images) ? p.images : ["https://placehold.co/400x400/f3f4f6/a3a3a3?text=DZ"]),
                        isNew: p.isNew === 'TRUE' || p.isNew === 'true' || p.isNew === true,
                    })));
                    
                    // ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨Ø§Øª
                    setOrders(fetchedOrders.map(o => {
                        let items = [];
                        let customer = {};
                        try { items = JSON.parse(o.itemsJson || '[]'); } catch (e) { console.error("Failed to parse itemsJson:", e); }
                        try { customer = JSON.parse(o.customerJson || '{}'); } catch (e) { console.error("Failed to parse customerJson:", e); }

                        return {
                            ...o,
                            id: Number(o.id),
                            total: Number(o.total),
                            items,
                            customer,
                        };
                    }));
                    showNotification('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­ Ù…Ù† Google Sheets.', 'green');

                } catch (error) {
                    console.error("Critical Load Error:", error);
                    setErrorMsg(`âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${error.message}. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· ÙˆØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù†Ø´Ø± (Anyone).`);
                    
                    // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
                    setProducts(MOCK_PRODUCTS);
                    setOrders(MOCK_ORDERS);
                    showNotification('ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© (Mock Data).', 'yellow');

                } finally {
                    setIsLoading(false);
                }
            }, [fetchData]);

            useEffect(() => {
                loadInitialData();
            }, [loadInitialData]);


            // --- Ø¯ÙˆØ§Ù„ Ø§Ù„Ø³Ù„Ø© (Cart Management) ---
            const updateCartQuantity = (id, change) => {
                setCart(prev => {
                    const updatedCart = prev.map(item => 
                        item.id === id ? { ...item, qty: item.qty + change } : item
                    ).filter(item => item.qty > 0);
                    return updatedCart;
                });
            };

            const addToCart = (product) => {
                setCart(prev => {
                    const existing = prev.find(item => item.id === product.id);
                    if (existing) {
                        showNotification(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ù‚Ø·Ø¹Ø© Ø£Ø®Ø±Ù‰ Ù…Ù† ${product.name}`, 'green');
                        return prev.map(item => item.id === product.id ? { ...item, qty: item.qty + 1 } : item);
                    }
                    showNotification(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${product.name} Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©`, 'green');
                    return [...prev, { ...product, qty: 1 }];
                });
                setIsCartOpen(true);
            };

            const clearCart = () => setCart([]);

            // --- Ø¯ÙˆØ§Ù„ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (Filtering & Sorting) ---
            const filteredAndSortedProducts = useMemo(() => {
                let filtered = products;

                // 1. Ø§Ù„ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø¨Ø­Ø«
                if (searchTerm) {
                    filtered = filtered.filter(p => 
                        p.name && p.name.toLowerCase().includes(searchTerm.toLowerCase())
                    );
                }

                // 2. Ø§Ù„ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©
                if (filterCategory !== 'ÙƒÙ„ Ø§Ù„ÙØ¦Ø§Øª') {
                    filtered = filtered.filter(p => p.category === filterCategory);
                }

                // 3. Ø§Ù„ÙØ±Ø²
                let sorted = [...filtered];
                switch (sortBy) {
                    case 'price_asc':
                        sorted.sort((a, b) => a.price - b.price);
                        break;
                    case 'price_desc':
                        sorted.sort((a, b) => b.price - a.price);
                        break;
                    case 'newest':
                    default:
                        // ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¬Ù„Ø¨ØŒ Ù„ÙƒÙ† Ù‡Ù†Ø§ Ù†Ø³ØªØ®Ø¯Ù… isNew Ù„ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø¸Ù‡ÙˆØ±
                        sorted.sort((a, b) => (b.isNew ? 1 : 0) - (a.isNew ? 1 : 0));
                        break;
                }
                
                return sorted;
            }, [products, searchTerm, filterCategory, sortBy]);

            // --- Ø­Ø³Ø§Ø¨ ØªÙƒÙ„ÙØ© Ø§Ù„Ø´Ø­Ù† ---
            const getShippingCost = (wilaya) => {
                if (!wilaya) return 0;
                // Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± Ø§Ù„Ø¹Ø§ØµÙ…Ø© ÙˆØ§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù‚Ø±ÙŠØ¨Ø© (Ù…Ø«Ù„ 16, 09, 35, 42) ØªÙƒÙ„ÙØ© Ø£Ù‚Ù„
                if (wilaya.includes('Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±') || wilaya.includes('Ø§Ù„Ø¨Ù„ÙŠØ¯Ø©') || wilaya.includes('Ø¨ÙˆÙ…Ø±Ø¯Ø§Ø³') || wilaya.includes('ØªÙŠØ¨Ø§Ø²Ø©')) {
                    return 400; // Ù…Ø«Ø§Ù„ Ù„ØªÙƒÙ„ÙØ© Ù…Ù†Ø®ÙØ¶Ø©
                }
                return 800; // Ø¨Ø§Ù‚ÙŠ Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª
            };
            
            // --- Ù…ÙƒÙˆÙ† Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ ---
            const LoadingOverlay = () => (
                <div className="fixed inset-0 bg-white/80 backdrop-blur-sm z-[200] flex items-center justify-center" dir="rtl">
                    <div className="flex items-center gap-3 bg-gray-900 text-white p-4 rounded-full shadow-lg">
                        <Icon icon="Loader2" className="animate-spin" size={24} />
                        <span className="font-bold">Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„/Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</span>
                    </div>
                </div>
            );

            // --- 1. Navbar (Shared)
            const Navbar = () => (
                <nav className="sticky top-0 z-50 bg-white/90 backdrop-blur-md shadow-sm border-b border-gray-100">
                    <div className="container mx-auto px-4 py-3 flex items-center justify-between">
                        <div className="flex items-center gap-2 cursor-pointer" onClick={() => setView('home')}>
                            <div className="bg-emerald-600 text-white p-2 rounded-xl font-black text-xl">DZ</div>
                            <h1 className="text-xl font-black text-gray-900 tracking-tighter hidden sm:block">Ø³ÙˆÙ‚ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</h1>
                        </div>
                        
                        {view.includes('admin') ? (
                            <div className="bg-gray-900 text-white px-3 py-1 rounded-full text-xs font-bold">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</div>
                        ) : (
                            <>
                                {/* Search Bar for Mobile/Tablet */}
                                <div className="flex-1 mx-4 max-w-lg relative md:hidden">
                                     <input 
                                        type="text" 
                                        placeholder="Ø¨Ø­Ø«..." 
                                        className="w-full bg-gray-100 border-none rounded-full py-2.5 px-4 pr-10 text-sm focus:ring-2 focus:ring-emerald-500"
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                    />
                                    <Icon icon="Search" className="absolute left-3 top-2.5 text-gray-400 w-5 h-5" />
                                </div>
                                
                                {/* Cart Button */}
                                <button 
                                    className="relative p-2.5 hover:bg-emerald-50 text-emerald-700 rounded-full transition-colors"
                                    onClick={() => setIsCartOpen(true)}
                                >
                                    <Icon icon="ShoppingCart" className="w-6 h-6" />
                                    {cart.length > 0 && (
                                        <span className="absolute top-1 right-1 bg-red-500 text-white text-[10px] font-bold w-4 h-4 flex items-center justify-center rounded-full animate-bounce">
                                            {cart.reduce((a, c) => a + c.qty, 0)}
                                        </span>
                                    )}
                                </button>
                            </>
                        )}
                    </div>
                </nav>
            );

            // --- 2. Admin Dashboard (Orders & Products Management)
            const AdminDashboard = () => {
                const totalSales = orders.filter(o => o.status === 'delivered').reduce((acc, order) => acc + order.total, 0);
                const pendingOrders = orders.filter(o => o.status === 'pending').length;

                const statusColors = {
                    pending: 'bg-orange-100 text-orange-600',
                    shipped: 'bg-blue-100 text-blue-600',
                    delivered: 'bg-green-100 text-green-600',
                    cancelled: 'bg-red-100 text-red-600'
                };

                return (
                    <div className="flex min-h-screen">
                        {/* Sidebar */}
                        <aside className="w-64 bg-gray-900 text-white hidden md:block flex-shrink-0">
                            <div className="p-6">
                                <h2 className="text-2xl font-bold mb-6 border-b border-gray-700 pb-4">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
                                <nav className="space-y-2">
                                    <button onClick={() => setAdminTab('dashboard')} className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-colors ${adminTab === 'dashboard' ? 'bg-emerald-600' : 'hover:bg-gray-800'}`}>
                                        <Icon icon="LayoutDashboard" size={20} /> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                                    </button>
                                    <button onClick={() => setAdminTab('products')} className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-colors ${adminTab === 'products' ? 'bg-emerald-600' : 'hover:bg-gray-800'}`}>
                                        <Icon icon="Package" size={20} /> Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                                    </button>
                                    <button onClick={() => setAdminTab('orders')} className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-colors ${adminTab === 'orders' ? 'bg-emerald-600' : 'hover:bg-gray-800'}`}>
                                        <Icon icon="ShoppingBag" size={20} /> Ø§Ù„Ø·Ù„Ø¨Ø§Øª
                                        {pendingOrders > 0 && <span className="bg-red-500 text-white text-xs px-2 py-0.5 rounded-full mr-auto">{pendingOrders}</span>}
                                    </button>
                                </nav>
                            </div>
                            <div className="p-4 mt-auto absolute bottom-0 w-64">
                                <button onClick={() => { setIsAdminAuthenticated(false); setView('home'); }} className="flex items-center gap-2 text-gray-400 hover:text-white transition-colors">
                                    <Icon icon="LogOut" size={18} /> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                                </button>
                            </div>
                        </aside>

                        {/* Main Content */}
                        <main className="flex-1 p-4 md:p-8 overflow-y-auto">
                             {/* Mobile Header and Tab Navigation */}
                            <div className="md:hidden mb-6">
                                <h2 className="text-2xl font-bold text-gray-800 mb-4">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
                                <div className="flex gap-2 border-b border-gray-200">
                                    <button onClick={() => setAdminTab('dashboard')} className={`px-4 py-2 text-sm font-semibold ${adminTab === 'dashboard' ? 'text-emerald-600 border-b-2 border-emerald-600' : 'text-gray-500'}`}>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
                                    <button onClick={() => setAdminTab('products')} className={`px-4 py-2 text-sm font-semibold ${adminTab === 'products' ? 'text-emerald-600 border-b-2 border-emerald-600' : 'text-gray-500'}`}>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
                                    <button onClick={() => setAdminTab('orders')} className={`px-4 py-2 text-sm font-semibold ${adminTab === 'orders' ? 'text-emerald-600 border-b-2 border-emerald-600' : 'text-gray-500'}`}>Ø§Ù„Ø·Ù„Ø¨Ø§Øª</button>
                                </div>
                            </div>


                            {/* DASHBOARD TAB */}
                            {adminTab === 'dashboard' && (
                                <div className="animate-fade-in">
                                    <h1 className="text-3xl font-bold text-gray-800 mb-8 hidden md:block">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</h1>
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                        {/* Card 1: Sales */}
                                        <div className="bg-white p-6 rounded-2xl shadow-md border border-gray-100">
                                            <div className="flex items-center justify-between mb-4">
                                                <div className="bg-emerald-100 p-3 rounded-full text-emerald-600"><Icon icon="DollarSign" size={24} /></div>
                                            </div>
                                            <h3 className="text-gray-500 text-sm">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª (Ø§Ù„Ù…Ø³Ù„Ù‘Ù…Ø©)</h3>
                                            <p className="text-3xl font-black text-gray-800">{totalSales.toLocaleString()} Ø¯.Ø¬</p>
                                        </div>
                                        {/* Card 2: Orders */}
                                        <div className="bg-white p-6 rounded-2xl shadow-md border border-gray-100">
                                            <div className="flex items-center justify-between mb-4">
                                                <div className="bg-blue-100 p-3 rounded-full text-blue-600"><Icon icon="ShoppingBag" size={24} /></div>
                                                {pendingOrders > 0 && <span className="text-orange-500 text-sm font-bold flex items-center gap-1"><Icon icon="AlertCircle" size={16}/> {pendingOrders} Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</span>}
                                            </div>
                                            <h3 className="text-gray-500 text-sm">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3>
                                            <p className="text-3xl font-black text-gray-800">{orders.length}</p>
                                        </div>
                                        {/* Card 3: Products */}
                                        <div className="bg-white p-6 rounded-2xl shadow-md border border-gray-100">
                                            <div className="flex items-center justify-between mb-4">
                                                <div className="bg-purple-100 p-3 rounded-full text-purple-600"><Icon icon="Package" size={24} /></div>
                                            </div>
                                            <h3 className="text-gray-500 text-sm">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h3>
                                            <p className="text-3xl font-black text-gray-800">{products.length}</p>
                                        </div>
                                    </div>
                                    {errorMsg && (
                                        <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-xl mb-4 text-sm" role="alert">
                                            <p className="font-bold">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</p>
                                            <p>{errorMsg}</p>
                                            <button onClick={loadInitialData} className="mt-2 text-xs font-semibold underline">Ø¥Ø¹Ø§Ø¯Ø© Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„</button>
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* PRODUCTS TAB */}
                            {adminTab === 'products' && (
                                <div className="animate-fade-in">
                                    <h1 className="text-3xl font-bold text-gray-800 mb-6 hidden md:block">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h1>
                                    <div className="bg-white p-6 rounded-2xl shadow-md border border-gray-100 mb-8">
                                        <h3 className="text-xl font-bold mb-4 flex items-center gap-2 text-emerald-700"><Icon icon="Plus" size={20}/> Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</h3>
                                        <form onSubmit={(e) => { e.preventDefault(); addProduct(); }} className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <input required placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬" className="bg-gray-50 p-3 rounded-lg border border-gray-200" value={newProduct.name} onChange={e => setNewProduct({...newProduct, name: e.target.value})} />
                                            <input required type="number" placeholder="Ø§Ù„Ø³Ø¹Ø± (Ø¯.Ø¬)" className="bg-gray-50 p-3 rounded-lg border border-gray-200" value={newProduct.price} onChange={e => setNewProduct({...newProduct, price: e.target.value})} />
                                            <select className="bg-gray-50 p-3 rounded-lg border border-gray-200" value={newProduct.category} onChange={e => setNewProduct({...newProduct, category: e.target.value})}>
                                                {PRODUCT_CATEGORIES.slice(1).map(cat => <option key={cat} value={cat}>{cat}</option>)}
                                            </select>
                                            <input placeholder="Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØµÙˆØ± (URL) - Ø§ÙØµÙ„ Ø¨ÙŠÙ†Ù‡Ø§ Ø¨Ø§Ù„Ø±Ù…Ø² |" className="bg-gray-50 p-3 rounded-lg border border-gray-200" value={newProduct.images} onChange={e => setNewProduct({...newProduct, images: e.target.value})} />
                                            <textarea required placeholder="ÙˆØµÙ Ù‚ØµÙŠØ± Ù„Ù„Ù…Ù†ØªØ¬" className="bg-gray-50 p-3 rounded-lg border border-gray-200" rows="2" value={newProduct.shortDesc} onChange={e => setNewProduct({...newProduct, shortDesc: e.target.value})}></textarea>
                                            <textarea required placeholder="Ø§Ù„ÙˆØµÙ Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ù…Ù†ØªØ¬" className="bg-gray-50 p-3 rounded-lg border border-gray-200" rows="2" value={newProduct.description} onChange={e => setNewProduct({...newProduct, description: e.target.value})}></textarea>
                                            <button type="submit" className="md:col-span-2 py-3 btn-primary" disabled={isLoading}>{isLoading ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...' : 'Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬'}</button>
                                        </form>
                                    </div>

                                    {/* Products Table */}
                                    <div className="bg-white rounded-2xl shadow-md border border-gray-100 overflow-x-auto">
                                        <table className="min-w-full text-right divide-y divide-gray-200">
                                            <thead className="bg-gray-50 text-gray-500 text-sm">
                                                <tr>
                                                    <th className="p-4">Ø§Ù„Ù…Ù†ØªØ¬</th>
                                                    <th className="p-4">Ø§Ù„Ø³Ø¹Ø±</th>
                                                    <th className="p-4">Ø§Ù„ØªØµÙ†ÙŠÙ</th>
                                                    <th className="p-4">Ø¬Ø¯ÙŠØ¯ØŸ</th>
                                                    <th className="p-4">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                                </tr>
                                            </thead>
                                            <tbody className="divide-y divide-gray-100">
                                                {products.map(p => (
                                                    <tr key={p.id} className="hover:bg-gray-50 transition-colors">
                                                        <td className="p-4 flex items-center gap-3">
                                                            <img src={p.images[0]} className="w-10 h-10 rounded-lg object-cover bg-gray-100" onError={(e) => {e.target.onerror = null; e.target.src="https://placehold.co/40x40/f3f4f6/a3a3a3?text=DZ"}} alt=""/>
                                                            <span className="font-bold text-gray-800">{p.name}</span>
                                                        </td>
                                                        <td className="p-4 text-emerald-600 font-bold">{p.price.toLocaleString()} Ø¯.Ø¬</td>
                                                        <td className="p-4"><span className="bg-gray-100 px-2 py-1 rounded text-xs">{p.category}</span></td>
                                                        <td className="p-4">{p.isNew ? <span className="text-green-500 font-semibold">Ù†Ø¹Ù…</span> : <span className="text-gray-400">Ù„Ø§</span>}</td>
                                                        <td className="p-4">
                                                            <button onClick={() => deleteProduct(p.id)} className="text-red-500 hover:bg-red-50 p-2 rounded-full transition-colors" disabled={isLoading}><Icon icon="Trash2" size={18}/></button>
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            )}

                            {/* ORDERS TAB */}
                            {adminTab === 'orders' && (
                                <div className="animate-fade-in space-y-4">
                                    <h1 className="text-3xl font-bold text-gray-800 mb-6 hidden md:block">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª ({orders.length})</h1>
                                    {orders.length === 0 ? <p className="text-gray-500 p-6 bg-white rounded-xl shadow-md">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.</p> : orders.map(order => (
                                        <div key={order.id} className="bg-white p-4 md:p-6 rounded-2xl shadow-md border border-gray-100">
                                            <div className="flex flex-col md:flex-row justify-between md:items-center mb-4 gap-3">
                                                <div>
                                                    <div className="flex items-center gap-2">
                                                        <span className="font-mono text-gray-400 text-sm">Ø·Ù„Ø¨ #{order.id.toString().slice(-6)}</span>
                                                        <span className="text-xs text-gray-500">{order.date}</span>
                                                    </div>
                                                    <h3 className="font-bold text-lg mt-1">{order.customer.fullName}</h3>
                                                    <p className="text-sm text-gray-500 flex items-center gap-1"><Icon icon="Phone" size={14}/> {order.customer.phone}</p>
                                                </div>
                                                
                                                <div className="flex flex-col items-start md:items-end gap-2">
                                                    <select 
                                                        value={order.status} 
                                                        onChange={(e) => updateOrderStatus(order.id, e.target.value)}
                                                        className={`px-3 py-1 rounded-full font-bold text-xs border-none outline-none cursor-pointer ${statusColors[order.status] || 'bg-gray-200 text-gray-700'}`}
                                                        disabled={isLoading}
                                                    >
                                                        <option value="pending">Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
                                                        <option value="shipped">ØªÙ… Ø§Ù„Ø´Ø­Ù†</option>
                                                        <option value="delivered">ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„</option>
                                                        <option value="cancelled">Ù…Ù„ØºØ§Ø©</option>
                                                    </select>
                                                    <div className="text-xl font-black text-emerald-700">{order.total.toLocaleString()} Ø¯.Ø¬</div>
                                                </div>
                                            </div>
                                            
                                            <div className="bg-gray-50 p-3 rounded-xl mt-4">
                                                <h4 className="text-xs font-bold text-gray-500 mb-2">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:</h4>
                                                <div className="flex flex-wrap gap-2">
                                                    {order.items.map((item, i) => (
                                                        <div key={i} className="flex items-center gap-2 bg-white px-3 py-1 rounded border border-gray-200 text-sm">
                                                            <span className="font-bold text-emerald-600">{item.qty}x</span>
                                                            <span>{item.name}</span>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </main>
                    </div>
                );
            };

            // --- Main Logic Switcher ---
            if (view === 'admin-login') {
                return (
                    <div className="min-h-screen bg-gray-100 flex items-center justify-center p-4">
                        {isLoading && <LoadingOverlay />}
                        <div className="bg-white p-8 rounded-2xl shadow-xl max-w-sm w-full border border-gray-100">
                            <div className="w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4 text-emerald-600">
                                <Icon icon="ShieldCheck" size={32} />
                            </div>
                            <h2 className="text-2xl font-bold text-center mb-6">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø´Ø±Ù</h2>
                            <form onSubmit={handleAdminLogin} className="space-y-4">
                                <input 
                                    type="password" 
                                    placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± (1234)" 
                                    className="w-full bg-gray-50 border border-gray-200 p-3 rounded-lg text-center tracking-widest"
                                    value={adminPass}
                                    onChange={e => setAdminPass(e.target.value)}
                                />
                                <button className="w-full py-3 btn-primary">Ø¯Ø®ÙˆÙ„</button>
                                <button type="button" onClick={() => setView('home')} className="w-full text-gray-400 text-sm hover:text-gray-600">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ØªØ¬Ø±</button>
                            </form>
                        </div>
                    </div>
                );
            }

            if (view === 'admin-dashboard') {
                return (
                    <div dir="rtl">
                        {isLoading && <LoadingOverlay />}
                        <AdminDashboard />
                    </div>
                );
            }

            // --- USER STOREFRONT RENDER ---
            return (
                <div className="min-h-screen text-gray-800 font-sans" dir="rtl">
                    {isLoading && <LoadingOverlay />}
                    <div id="message-box"></div> 
                    <Navbar />
                    
                    {/* Home View */}
                    {view === 'home' && (
                        <main className="container mx-auto px-4 py-6">
                            {/* Hero Section */}
                            <div className="bg-gray-900 rounded-3xl p-8 mb-10 text-white shadow-xl relative overflow-hidden">
                                <div className="relative z-10 max-w-2xl">
                                    <h2 className="text-3xl md:text-4xl font-bold mb-4 leading-tight">Ù…ØªØ¬Ø± Ø£Ø­Ù„Ø§Ù…Ùƒ <br/>Ø¨ÙŠÙ† ÙŠØ¯ÙŠÙƒ</h2>
                                    <p className="text-gray-400 mb-6">Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± Ù…Ø¹ Ø®Ø¯Ù…Ø© Ø§Ù„ØªÙˆØµÙŠÙ„ ÙˆØ§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù….</p>
                                    <button onClick={() => document.getElementById('products-section').scrollIntoView({behavior:'smooth'})} className="bg-emerald-500 text-white px-8 py-3 rounded-full font-bold hover:bg-emerald-600 transition-all">ØªØµÙØ­ Ø§Ù„Ø¹Ø±ÙˆØ¶</button>
                                </div>
                            </div>

                            {/* Filters and Sorting */}
                            <div className="flex flex-col md:flex-row gap-3 mb-6 items-center">
                                {/* Search Bar (Desktop) */}
                                <div className="hidden md:flex flex-1 relative">
                                     <input 
                                        type="text" 
                                        placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." 
                                        className="w-full bg-white border border-gray-200 rounded-xl py-2.5 px-4 pr-10 focus:ring-2 focus:ring-emerald-500"
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                    />
                                    <Icon icon="Search" className="absolute left-3 top-2.5 text-gray-400 w-5 h-5" />
                                </div>
                                {/* Category Filter */}
                                <div className="w-full md:w-auto flex-shrink-0">
                                    <select 
                                        className="bg-white border border-gray-200 p-3 rounded-xl w-full md:w-48 text-sm focus:ring-2 focus:ring-emerald-500"
                                        value={filterCategory}
                                        onChange={(e) => setFilterCategory(e.target.value)}
                                    >
                                        {PRODUCT_CATEGORIES.map(cat => <option key={cat} value={cat}>{cat}</option>)}
                                    </select>
                                </div>
                                {/* Sorting */}
                                <div className="w-full md:w-auto flex-shrink-0">
                                    <select 
                                        className="bg-white border border-gray-200 p-3 rounded-xl w-full md:w-48 text-sm focus:ring-2 focus:ring-emerald-500"
                                        value={sortBy}
                                        onChange={(e) => setSortBy(e.target.value)}
                                    >
                                        <option value="newest">Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹</option>
                                        <option value="price_asc">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø£Ø¹Ù„Ù‰</option>
                                        <option value="price_desc">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ù„Ø£Ø¯Ù†Ù‰</option>
                                    </select>
                                </div>
                            </div>
                            
                            {/* Products Grid */}
                            <div id="products-section" className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4 md:gap-6">
                                {filteredAndSortedProducts.length === 0 ? (
                                    <div className="col-span-2 md:col-span-4 lg:col-span-5 text-center py-10 bg-white rounded-xl shadow-md border border-gray-100">
                                        <p className="text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù…Ø±Ø´Ø­Ø§Øª Ø§Ù„Ø¨Ø­Ø«.</p>
                                    </div>
                                ) : (
                                    filteredAndSortedProducts.map(product => (
                                        <div key={product.id} className="bg-white rounded-2xl p-3 shadow-sm border border-gray-100 hover:shadow-lg transition-shadow group cursor-pointer" 
                                             onClick={() => { setSelectedProduct(product); setView('product-detail'); }}>
                                            
                                            <div className="relative rounded-xl overflow-hidden mb-3 aspect-square bg-gray-100">
                                                <img src={product.images[0]} alt={product.name} onError={(e) => {e.target.onerror = null; e.target.src="https://placehold.co/200x200/f3f4f6/a3a3a3?text=DZ+Item"}} className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"/>
                                                {product.isNew && <span className="absolute top-2 right-2 bg-red-500 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-md">Ø¬Ø¯ÙŠØ¯</span>}
                                                <button onClick={(e) => {e.stopPropagation(); addToCart(product);}} className="absolute bottom-3 right-3 p-2 rounded-full shadow-lg bg-emerald-600 text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300 active:scale-90">
                                                    <Icon icon="ShoppingCart" size={20}/>
                                                </button>
                                            </div>
                                            
                                            <h3 className="font-bold text-gray-900 text-base md:text-lg mb-1 truncate">{product.name}</h3>
                                            <div className="flex justify-between items-center mt-2">
                                                <span className="text-emerald-700 font-bold text-lg">{product.price.toLocaleString()} Ø¯.Ø¬</span>
                                                <span className="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full">{product.category}</span>
                                            </div>
                                        </div>
                                    ))
                                )}
                            </div>
                        </main>
                    )}

                    {/* Product Detail View */}
                    {view === 'product-detail' && selectedProduct && (
                        <div className="container mx-auto px-4 py-8 animate-fade-in max-w-6xl">
                            <button onClick={() => setView('home')} className="mb-6 flex items-center gap-2 text-gray-500 hover:text-gray-900 transition-colors">
                                <Icon icon="ArrowRight" size={20}/> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª
                            </button>
                            
                            <div className="bg-white p-6 md:p-10 rounded-3xl shadow-lg border border-gray-100">
                                <div className="grid md:grid-cols-2 gap-8 md:gap-12">
                                    {/* Image Gallery */}
                                    <div className="space-y-4">
                                        <img 
                                            src={selectedProduct.images[0]} 
                                            className="w-full rounded-2xl bg-gray-100 object-cover aspect-square shadow-sm" 
                                            alt={selectedProduct.name}
                                            onError={(e) => {e.target.onerror = null; e.target.src="https://placehold.co/400x400/f3f4f6/a3a3a3?text=DZ+Item+Image"}}
                                        />
                                        {/* Thumbnail Gallery (if multiple images) */}
                                        {selectedProduct.images.length > 1 && (
                                            <div className="flex gap-2 overflow-x-auto hide-scrollbar">
                                                {selectedProduct.images.map((img, index) => (
                                                    <img 
                                                        key={index}
                                                        src={img}
                                                        className="w-16 h-16 rounded-lg object-cover cursor-pointer opacity-70 hover:opacity-100 transition-opacity"
                                                        alt={`ØµÙˆØ±Ø© ${index+1}`}
                                                    />
                                                ))}
                                            </div>
                                        )}
                                    </div>

                                    {/* Product Details */}
                                    <div>
                                        <h1 className="text-3xl font-black mb-2 text-gray-900">{selectedProduct.name}</h1>
                                        <div className="flex items-center gap-2 text-yellow-500 mb-4">
                                            {Array(5).fill(0).map((_, i) => <Icon key={i} icon="Star" size={18} fill={i < Math.round(selectedProduct.rating) ? "currentColor" : "none"}/>)}
                                            <span className="text-sm text-gray-500 mr-2">({selectedProduct.reviews} ØªÙ‚ÙŠÙŠÙ…)</span>
                                        </div>
                                        
                                        <p className="text-gray-600 text-lg leading-relaxed mb-6 whitespace-pre-line">{selectedProduct.description || selectedProduct.shortDesc}</p>
                                        
                                        <div className="grid grid-cols-2 gap-4 mb-8">
                                            <div className="bg-gray-50 p-4 rounded-xl flex items-center gap-3 border border-gray-100">
                                                <Icon icon="Truck" className="text-emerald-600"/> <div><p className="font-bold text-sm">ØªÙˆØµÙŠÙ„ 58 ÙˆÙ„Ø§ÙŠØ©</p><p className="text-xs text-gray-400">Ø³Ø±ÙŠØ¹ ÙˆÙ…Ø¶Ù…ÙˆÙ†</p></div>
                                            </div>
                                            <div className="bg-gray-50 p-4 rounded-xl flex items-center gap-3 border border-gray-100">
                                                <Icon icon="ShieldCheck" className="text-emerald-600"/> <div><p className="font-bold text-sm">Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</p><p className="text-xs text-gray-400">Ø§ÙØªØ­ ÙˆØªØ£ÙƒØ¯ Ù‚Ø¨Ù„ Ø§Ù„Ø¯ÙØ¹</p></div>
                                            </div>
                                        </div>

                                        <div className="flex items-center justify-between border-t pt-4">
                                            <span className="text-4xl font-black text-emerald-600">{selectedProduct.price.toLocaleString()} Ø¯.Ø¬</span>
                                            <div className="flex gap-3">
                                                <button onClick={() => addToCart(selectedProduct)} className="px-6 py-3 btn-secondary flex items-center gap-2">
                                                    <Icon icon="ShoppingCart" size={20}/> Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©
                                                </button>
                                                <button onClick={() => {addToCart(selectedProduct); setView('checkout')}} className="px-6 py-3 btn-primary">
                                                    Ø´Ø±Ø§Ø¡ Ø§Ù„Ø¢Ù†
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Checkout View */}
                    {view === 'checkout' && (
                        <div className="container mx-auto px-4 py-8 max-w-4xl animate-fade-in">
                            <button onClick={() => setView('home')} className="mb-6 flex items-center gap-2 text-gray-500 hover:text-gray-900"><Icon icon="ArrowRight" size={20}/> Ø¥Ù„ØºØ§Ø¡ ÙˆØ§Ù„Ø¹ÙˆØ¯Ø©</button>
                            <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                                
                                {/* Order Summary (Left/Top) */}
                                <div className="lg:col-span-1 bg-white p-6 rounded-2xl shadow-lg border border-gray-100 order-2 lg:order-1">
                                    <h3 className="text-xl font-bold mb-4 border-b pb-3">Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨</h3>
                                    <div className="space-y-3 mb-6">
                                        {cart.map(item => (
                                            <div key={item.id} className="flex justify-between items-center text-sm">
                                                <div className="flex items-center gap-2">
                                                     <img src={item.images[0]} className="w-8 h-8 rounded object-cover" onError={(e) => {e.target.onerror = null; e.target.src="https://placehold.co/40x40/f3f4f6/a3a3a3?text=DZ"}} alt=""/>
                                                     <span>{item.name}</span>
                                                </div>
                                                <span className="font-bold text-gray-700">{item.qty} x {item.price.toLocaleString()} Ø¯.Ø¬</span>
                                            </div>
                                        ))}
                                    </div>

                                    {/* Cost Breakdown */}
                                    <div className="border-t pt-4">
                                        <div className="flex justify-between mb-2 text-gray-500 text-sm"><span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ (Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª)</span><span>{cart.reduce((a,c) => a + (c.price*c.qty),0).toLocaleString()} Ø¯.Ø¬</span></div>
                                        <div className="flex justify-between mb-4 text-gray-500 text-sm"><span>ØªÙƒÙ„ÙØ© Ø§Ù„ØªÙˆØµÙŠÙ„</span><span>{getShippingCost(formData.wilaya).toLocaleString()} Ø¯.Ø¬</span></div>
                                        <div className="flex justify-between text-2xl font-black text-gray-900 border-t pt-3">
                                            <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span>
                                            <span className="text-emerald-600">{(cart.reduce((a,c) => a + (c.price*c.qty),0) + getShippingCost(formData.wilaya)).toLocaleString()} Ø¯.Ø¬</span>
                                        </div>
                                    </div>
                                </div>

                                {/* Address Form (Right/Bottom) */}
                                <div className="lg:col-span-2 bg-white p-6 rounded-2xl shadow-lg border border-gray-100 order-1 lg:order-2">
                                    <h2 className="text-2xl font-bold mb-6">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø­Ù†</h2>
                                    <form onSubmit={placeOrder} className="space-y-4">
                                        <input required placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" className="w-full bg-gray-50 p-4 rounded-xl border-none outline-none focus:ring-2 focus:ring-emerald-500" value={formData.fullName} onChange={e => setFormData({...formData, fullName: e.target.value})} />
                                        <input required placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (Ø¶Ø±ÙˆØ±ÙŠ)" type="tel" className="w-full bg-gray-50 p-4 rounded-xl border-none outline-none focus:ring-2 focus:ring-emerald-500" value={formData.phone} onChange={e => setFormData({...formData, phone: e.target.value})} />
                                        <div className="grid grid-cols-2 gap-4">
                                            <select required className="bg-gray-50 p-4 rounded-xl outline-none" value={formData.wilaya} onChange={e => setFormData({...formData, wilaya: e.target.value})}>
                                                <option value="" disabled>Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ„Ø§ÙŠØ©</option>
                                                {WILAYAS.map(w => <option key={w} value={w}>{w}</option>)}
                                            </select>
                                            <input required placeholder="Ø§Ù„Ø¨Ù„Ø¯ÙŠØ©" className="bg-gray-50 p-4 rounded-xl outline-none" value={formData.commune} onChange={e => setFormData({...formData, commune: e.target.value})} />
                                        </div>
                                        <textarea required placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„" className="w-full bg-gray-50 p-4 rounded-xl border-none outline-none" rows="3" value={formData.address} onChange={e => setFormData({...formData, address: e.target.value})}></textarea>
                                        
                                        <button className="w-full py-4 btn-primary text-lg mt-6 shadow-xl shadow-emerald-200" disabled={isLoading}>
                                            {isLoading ? 'Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨...' : `ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ¯ÙØ¹ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ`}
                                        </button>
                                        <p className="text-xs text-gray-500 text-center flex items-center justify-center gap-1">
                                            <Icon icon="ShieldCheck" size={14}/> Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ù…ØªØ§Ø­ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª
                                        </p>
                                    </form>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Success View */}
                    {view === 'success' && (
                        <div className="min-h-[60vh] flex flex-col items-center justify-center text-center p-4">
                            <div className="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center text-green-600 mb-6 animate-pulse"><Icon icon="CheckCircle" size={40}/></div>
                            <h2 className="text-3xl font-bold mb-2">Ø´ÙƒØ±Ø§Ù‹ Ù„Ø·Ù„Ø¨Ùƒ!</h2>
                            <p className="text-gray-500 mb-8">Ù„Ù‚Ø¯ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­. Ø³Ù†Ù‚ÙˆÙ… Ø¨Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ù„ØªØ£ÙƒÙŠØ¯ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø´Ø­Ù†.</p>
                            <button onClick={() => {setView('home'); setFormData({fullName:'', phone:'', wilaya:WILAYAS[0], commune:'', address:''})}} className="px-8 py-3 btn-primary rounded-full">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
                        </div>
                    )}

                    {/* Footer & Admin Entry */}
                    <footer className="mt-16 border-t border-gray-200 py-8 text-center bg-white shadow-inner">
                        <p className="text-gray-500 mb-4">Â© 2024 Ø³ÙˆÙ‚ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± DZ Shop. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
                        <button onClick={() => setView('admin-login')} className="text-xs text-gray-400 hover:text-emerald-600 transition-colors flex items-center justify-center gap-1 mx-auto">
                            <Icon icon="LayoutDashboard" size={12} /> Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
                        </button>
                    </footer>

                    {/* Cart Sidebar */}
                    {isCartOpen && (
                        <div className="fixed inset-0 z-[100] flex justify-end">
                            <div className="absolute inset-0 bg-black/40 backdrop-blur-sm" onClick={() => setIsCartOpen(false)}></div>
                            <div className="relative bg-white w-full max-w-md h-full shadow-2xl p-6 flex flex-col animate-slide-in-right">
                                
                                <div className="flex justify-between items-center mb-6 border-b pb-3">
                                    <h2 className="text-2xl font-black">Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h2>
                                    <button onClick={() => setIsCartOpen(false)} className="p-2 hover:bg-gray-100 rounded-full"><Icon icon="X" className="text-gray-500"/></button>
                                </div>
                                
                                <div className="flex-1 overflow-y-auto hide-scrollbar space-y-4">
                                    {cart.length === 0 ? (
                                        <div className="text-center text-gray-500 mt-10">
                                            <Icon icon="ShoppingCart" size={48} className="mx-auto text-gray-300 mb-3"/>
                                            <p>Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©. Ø£Ø¶Ù Ù…Ù†ØªØ¬Ø§ØªÙƒ Ø§Ù„Ù…ÙØ¶Ù„Ø©!</p>
                                        </div>
                                    ) : (
                                        cart.map(item => (
                                            <div key={item.id} className="flex gap-4 border-b border-gray-100 pb-4 items-center">
                                                <img src={item.images[0]} className="w-16 h-16 rounded-xl object-cover bg-gray-50 flex-shrink-0" alt="" onError={(e) => {e.target.onerror = null; e.target.src="https://placehold.co/40x40/f3f4f6/a3a3a3?text=DZ"}}/>
                                                <div className="flex-1">
                                                    <h4 className="font-bold text-base truncate">{item.name}</h4>
                                                    <p className="text-emerald-600 font-bold text-sm">{item.price.toLocaleString()} Ø¯.Ø¬</p>
                                                </div>
                                                <div className="flex items-center gap-2 bg-gray-100 p-1 rounded-full flex-shrink-0">
                                                    <button onClick={() => updateCartQuantity(item.id, 1)} className="p-1 bg-white rounded-full text-emerald-600"><Icon icon="Plus" size={16}/></button>
                                                    <span className="font-bold text-sm w-4 text-center">{item.qty}</span>
                                                    <button onClick={() => updateCartQuantity(item.id, -1)} className="p-1 bg-white rounded-full text-gray-500"><Icon icon="Minus" size={16}/></button>
                                                </div>
                                            </div>
                                        ))
                                    )}
                                </div>
                                
                                {cart.length > 0 && (
                                    <div className="mt-6 border-t pt-4">
                                        <div className="flex justify-between text-lg font-bold mb-4">
                                            <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ±Ø¹ÙŠ:</span>
                                            <span className="text-emerald-700">{cart.reduce((a,c) => a + (c.price*c.qty),0).toLocaleString()} Ø¯.Ø¬</span>
                                        </div>
                                        <button onClick={() => {setIsCartOpen(false); setView('checkout')}} className="w-full py-3 btn-primary text-lg">
                                            Ù…ØªØ§Ø¨Ø¹Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¯ÙØ¹
                                        </button>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        // Ù…Ù„Ø§Ø­Ø¸Ø©: ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„ÙƒØªÙ„Ø© Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Babel
        window.onload = () => {
             if (document.getElementById('root')) {
                 ReactDOM.render(<App />, document.getElementById('root'));
            }
        };
    </script>
</body>
</html>

