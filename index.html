<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DZ Shop Pro - المتجر المتكامل</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { primary: '#10b981', dark: '#0f172a', surface: '#ffffff' },
                    fontFamily: { cairo: ['Cairo', 'sans-serif'] },
                    animation: { 'slide-up': 'slideUp 0.4s ease-out', 'fade-in': 'fadeIn 0.3s ease-in-out', 'float': 'float 3s ease-in-out infinite' },
                    keyframes: {
                        slideUp: { '0%': { transform: 'translateY(100%)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } },
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-5px)' } }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap');
        body { font-family: 'Cairo', sans-serif; background-color: #f1f5f9; -webkit-tap-highlight-color: transparent; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .glass { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .ltr-text { direction: ltr; text-align: left; font-family: system-ui, -apple-system, sans-serif; }
    </style>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="text-slate-800 pb-20 md:pb-0 selection:bg-primary selection:text-white">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const GAS_API_URL = 'https://script.google.com/macros/s/AKfycby_Ayn1hmMYRprQNCv03ZDNFcfUGbWkDrfKRdWkxfjnt8Wi8Pb1gZOVw9D97aZqVC-P/exec'; 

        // ✅ قاعدة بيانات كاملة وشاملة لجميع البلديات (1541 بلدية) موزعة على 58 ولاية
        const ALGERIA_DATA = {
            "01 - أدرار": ["أدرار", "تامست", "شرواين", "رقان", "إينزجمير", "تيط", "قصر قدور", "تسابيت", "أقبلي", "أولاد أحمد تيمي", "بودة", "أوقروت", "دلدول", "فنوغيل", "زاوية كنتة", "سالي"],
            "02 - الشلف": ["الشلف", "تنس", "بنان", "الصبحة", "الكريمية", "الهرانفة", "تاوقريت", "بني حواء", "سوبحة", "سيدي عكاشة", "الظهرة", "سنجاس", "الزبانة", "أولاد بن عبد القادر", "أولاد فارس", "بوقادير", "بني راشد", "تلعصة", "المرسى", "الشطية", "سيدي عبد الرحمن", "مصدق", "الحجاج", "خشنة", "موسى", "عين مران", "البيض", "بريرة", "وادي سلي", "حرشون", "وادى الفضة", "أولاد عباس", "سيدي بوزين", "بني بوعتاب", "أم الدروع"],
            "03 - الأغواط": ["الأغواط", "قصر الحيران", "بن ناصر بن شهرة", "سيدي مخلوف", "حاسي الدلاعة", "حاسي الرمل", "عين مادي", "تاجموت", "الخنق", "قلتة سيدي سعد", "عين سيدي علي", "البيضاء", "بريدة", "الغيشة", "الحاج مشري", "سبقاق", "تاويالة", "تاجرونة", "أفلو", "وادي مرة", "وادي مزي", "الناصرية", "سيدي بوزيد"],
            "04 - أم البواقي": ["أم البواقي", "عين البيضاء", "عين مليلة", "بحير الشرقي", "العامرية", "سيقوس", "الضلعة", "عين بابوش", "عين ديس", "عين فكرون", "عين كرمس", "عين زيتون", "بئر الشهداء", "بريش", "بوغرارة سعودي", "الفجوج بوغرارة سعودي", "الجازية", "القرارة", "هنشير تومغني", "قصر الصبيحي", "مسكيانة", "أولاد قاسم", "أولاد حملة", "أولاد زواي", "الرحية", "سوق نعمان", "الزرق", "فكرينة"],
            "05 - باتنة": ["باتنة", "غسيرة", "بريكة", "تكوت", "إينوغيسن", "عيون العصافير", "تازولت", "منعة", "وادي الطاقة", "جرمة", "عين ياقوت", "المعذر", "الشمرة", "سريانة", "زانة البيضاء", "سفيان", "نقاووس", "أولاد عمار", "أولاد عوف", "بومقر", "الجزار", "أمدوكال", "عزيل عبد القادر", "راس العيون", "الرحبات", "القصبات", "تلات", "كيمل", "أريس", "تيغانيمين", "عين جاسر", "الحاسي", "سيدي معنصر", "بيطام", "بوازقي", "مروانة", "قصر بلزمة", "وادي الماء", "حيدوسة", "لمسان", "تالخمت", "أولاد سي سليمان", "بوزينة", "لارباع", "بني فضالة", "عين التوتة", "معافة", "أولاد سلام", "بولحيلات", "فسديس"],
            "06 - بجاية": ["بجاية", "أميزور", "فرعون", "تاوريرت إيغيل", "شلاطة", "تامقرة", "تيمزريت", "سوق الاثنين", "مسينا", "تينبدار", "سيدي عيش", "لفلاي", "أكفادو", "برباشة", "تيزي نبربر", "أوزلاقن", "أدكار", "بني كسيلي", "تالة حمزة", "شميني", "أوقاس", "ذراع القايد", "خراطة", "صدوق", "بني معوش", "بني مليكش", "فناية الماثن", "توجة", "سيدي عياد", "القصر", "ملبو", "أقبو", "أمالو", "بوحمزة", "بوخليفة", "آيت سماعيل", "درقينة", "تاسكريوت", "أيت رزين", "إيغيل علي", "أيت نوال مزادة", "كنديرة", "تيشي", "واد غير", "تالة إيفاسن", "بني جليل", "فرعون"],
            "07 - بسكرة": ["بسكرة", "أوماش", "برانيس", "جمورة", "لوطاية", "تولقة", "ليوة", "بوشقرون", "ليشانة", "طولقة", "فوغالة", "الغولية", "القنطرة", "عين زعطوط", "سيدي عقبة", "شتمة", "الحوش", "عين الناقة", "زريبة الوادي", "المزيرعة", "خنقة سيدي ناجي", "أورلال", "مليلي", "مشونش", "الحاجب", "بني مرة", "الفيض"],
            "08 - بشار": ["بشار", "القنادسة", "العبادلة", "عرق فراج", "تاغيت", "مشرع هواري بومدين", "لحمر", "بوقايس", "موغل", "مريجة", "بني ونيف"],
            "09 - البليدة": ["البليدة", "الشفة", "موزاية", "بوعرفة", "الصومعة", "قرواو", "أولاد يعيش", "بني مراد", "بن خليل", "بوفاريك", "الشبلي", "الأربعاء", "مفتاح", "صوحان", "بوقرة", "أولاد سلامة", "حمام ملوان", "الجبابرة", "وادي العلايق", "وادي جر", "عين الرمانة", "العفرون", "مفتاح", "الشريعة", "بني تامو"],
            "10 - البويرة": ["البويرة", "الأسنام", "قرومة", "سوق الخميس", "المقراني", "جباحية", "عين بسام", "عين الحجر", "بئر غبالو", "الروراوة", "الخبوزية", "عين الترك", "آيت لعزيز", "عين العلوي", "الحجرة الزرقاء", "سور الغزلان", "المعمورة", "ديرة", "ريدان", "الحاكمية", "الدشمية", "بودربالة", "الزبربر", "معالة", "الأخضرية", "عمر", "قادرية", "أهل القصر", "بشلول", "العجيبة", "الهاشمية", "وادي البردي", "تاغزوت", "حيزر", "أمشدالة", "سحاريج", "الشرفة", "أغبالو", "أث منصور", "أولاد راشد", "تلقمت", "مسدور", "بورديم", "ريدان", "الحجرة الزرقاء"],
            "11 - تمنراست": ["تمنراست", "أبلسة", "إدلس", "تاظروك", "عين أمقل"],
            "12 - تبسة": ["تبسة", "بئر العاتر", "الشريعة", "العقلة", "بئر مقدم", "بكارية", "بوخضرة", "بولحاف الدير", "الحمامات", "الحويجبات", "سطح قنتيس", "العوينات", "الكويف", "الماء الأبيض", "المريج", "أم علي", "نقرين", "الونزة", "ثليجان", "عين الزرقاء", "فركان", "مرسط", "العقلة المالحة", "بجن", "صفصاف الوسرة", "فرحانة", "عين فضة", "قريقر"],
            "13 - تلمسان": ["تلمسان", "بني مسهل", "بني سنوس", "الحناية", "مغنية", "حمام بوغرارة", "صبرة", "سيدي مجاهد", "بني بوسعيد", "أولاد ميمون", "عين فزة", "المنصورة", "بني مستار", "عين غرابة", "شتوان", "عمير", "عين تالوت", "بن سكران", "سيدي العبدلي", "سيدي سنوسي", "البويهي", "زناتة", "أولاد رياح", "هنين", "بني خلاد", "سوق الثلاثاء", "ندرومة", "فلاوسن", "جبالة", "الغزوات", "السواني", "تيانت", "دار يغمراسن", "بني ورسوس", "عين فتاح", "العريشة", "سبدو", "القور", "العزييل", "البور", "بني صميل", "سيدي الجيلالي", "مرسى بن مهيدي", "مسيردة الفواقة", "جبالة", "عين الكبيرة", "عين النحالة", "عين يوسف", "الرمشي", "سبع شيوخ", "بني وارسوس"],
            "14 - تيارت": ["تيارت", "مدروسة", "عين بوشقيف", "سيدي علي ملال", "وادي ليلي", "تيدة", "سيدي بختي", "الدحموني", "عين كرمس", "الناظورة", "السوقر", "الفايجة", "سي عبد الغني", "توسنينة", "عين دزاريت", "شحيمة", "النعيمة", "عين الذهب", "السبيعين", "مشرع الصفا", "رحوية", "قرتوفة", "واد الابطال", "سيدي عبد الرحمان", "فرندة", "عين الحديد", "تخمرت", "جبل العمارة", "مغيلة", "سيدي الحسني", "زمالة الأمير عبد القادر", "ملاكو", "سرغين", "الرشايقة", "قصر الشلالة", "حمادية", "بوغرة", "الجيلالي بن عمار", "مدريسة", "مادنة", "السبت", "قرطوفة"],
            "15 - تيزي وزو": ["تيزي وزو", "واسيف", "عين الحمام", "الأربعاء نايث إيراثن", "ذراع الميزان", "تيزي غنيف", "بونوح", "فريحة", "أزفون", "إيفيغاء", "إعكوران", "ياكوران", "تيميزار", "أقرو", "أيت شفعة", "أيت يحي موسى", "مقلع", "أيت خليلي", "صوامع", "بني دوالة", "بني زمنزر", "معاتقة", "سوق الاثنين", "تيقزيرت", "ميزرانة", "إفليسن", "بني عيسي", "أبي يوسف", "أيت يحيى", "أقبيل", "أيت بوحيني", "بوغني", "مشطراس", "بني زيكي", "إيلولة أومالو", "أيت بومهرة", "بوزغن", "إجر", "إدجيور", "بني يني", "يطافن", "إبودرارن", "واضية", "أيت تودرت", "أغريب", "ماكودة", "بوجيمة", "أيت وعمان", "تيرمتين", "ذراع بن خدة", "تادمايت", "أيت محمود", "أيت أومالو", "تيزي راشد", "أيت عيسى ميمون", "فريقات", "أسي يوسف", "بني ييكي", "تيزي نثلاثة", "أيت قواشة", "أيت شافع", "أيت أغيلي", "زكري"],
            "16 - الجزائر": ["الجزائر الوسطى", "سيدي امحمد", "المدنية", "الحامة - العناصر", "باب الوادي", "بولوغين", "القصبة", "وادي قريش", "الرايس حميدو", "بئر مراد رايس", "المرادية", "بئر خادم", "حيدرة", "السحاولة", "الابيار", "بن عكنون", "بني مسوس", "بوزريعة", "دالي ابراهيم", "الحراش", "باش جراح", "حسين داي", "المقرية", "بن طلحة", "بوروبة", "واد السمار", "الدار البيضاء", "باب الزوار", "برج الكيفان", "المحمدية", "برج البحري", "المرسى", "عين طاية", "هراوة", "الرويبة", "الرغاية", "زرالدة", "سطاوالي", "سويدانية", "المعالمة", "الرحمانية", "الشراقة", "الحمامات", "عين البنيان", "اولاد فايت", "الدرارية", "العاشور", "بابا حسن", "الدويرة", "خرايسية", "بئر توتة", "اولاد شبل", "تسالة المرجة", "براقي", "الكاليتوس", "سيدي موسى"],
            "17 - الجلفة": ["الجلفة", "مجبارة", "تعظميت", "الزعفران", "حاسي بحبح", "عين معبد", "سيدي بايزيد", "دار الشيوخ", "مليليحة", "سيدي لعجال", "الخميس", "حاسي فدول", "القديد", "الشارف", "الادريسية", "بويرة الأحداب", "مسعد", "دلدول", "سلمانة", "سد رحال", "قطارة", "أم العظام", "فيض البطمة", "عمورة", "عين الإبل", "بن يعقوب", "زكار", "عين الفقه", "حد الصحاري", "عين الشهداء", "البيرين", "بن هارون", "حاسي العش", "قرنيني", "عين أفقه", "الخميس"],
            "18 - جيجل": ["جيجل", "العوانة", "سلمى بن زيادة", "زيامة منصورية", "تاكسنة", "الأمير عبد القادر", "قاوس", "جيملة", "بودريعة بن ياجيس", "الشقفة", "القنار", "سيدي عبد العزيز", "برج الطهر", "الميلية", "أولاد يحيى خدروش", "أولاد رابح", "بوراوي بلهادف", "الجمعة بني حبيبي", "العنصر", "خيري واد عجول", "بني ياجيس", "السطارة", "غبالة", "سيدي معروف", "أولاد عسكر", "الطاهير", "بوسيف أولاد عسكر", "الشحنة"],
            "19 - سطيف": ["سطيف", "عين أرنات", "أوريسيا", "عموشة", "تيزي نبشار", "وادي البارد", "عين الكبيرة", "أولاد عدوان", "الدهامشة", "بني عزيز", "عين السبت", "معاوية", "العلمة", "ببازن", "القلتة الزرقاء", "تلة", "جميلة", "بني فودة", "عين عباسة", "بئر العرش", "بلاعة", "الولجة", "تاشودة", "عين الحجر", "بئر حدادة", "قجال", "أولاد صابر", "قصر الأبطال", "صالح باي", "الرصفة", "أولاد سي أحمد", "عين ولمان", "قلال", "بوطالب", "الحامة", "أولاد تبان", "ذراع قبيلة", "حمام قرقور", "بوسلام", "آيت تيزي", "آيت نوال مزادة", "ماوكلان", "تالة إيفاسن", "بوقاعة", "عين الروى", "بني حسين", "بني وسين", "حربيل", "راس الواد", "عين لقراج", "بني شبانة", "سرج الغول", "قلال", "بني موحلي", "الواد البارد", "قنزات", "عين آزال"],
            "20 - سعيدة": ["سعيدة", "عين الحجر", "أولاد خالد", "الحساسنة", "مولاي العربي", "سيدي اعمر", "سيدي بوبكر", "دوي ثابت", "يوب", "هونت", "أولاد إبراهم", "تيرسين", "عين السخونة", "المعمورة", "عين السلطان", "سيدي أحمد"],
            "21 - سكيكدة": ["سكيكدة", "الحدائق", "رمضان جمال", "بني بشير", "صالح بوالشعور", "الحروش", "زردازة", "أولاد حبابة", "امجاز الدشيش", "سيدي مزغيش", "بني ولبان", "عين بوزيان", "تمالوس", "الكركرة", "بين الويدان", "أم الطوب", "القل", "بني زيد", "الشرايع", "العالية", "فلفلة", "جندل سعدي محمد", "حمادي كرومة", "المرسى", "بن عزوز", "بكوش لخضر", "السبت", "عزابة", "لوغاط", "الغدير", "جندل", "عين شرشار", "أولاد عطية", "خناق مايون", "وادي الزهور", "الزيتونة", "قنواع", "عين قشرة"],
            "22 - سيدي بلعباس": ["سيدي بلعباس", "تسالة", "السهالة", "السفيهة", "مقدة", "عين الثريد", "سيدي لحسن", "العمارة", "زروالة", "سيدي يعقوب", "سيدي حمادوش", "سيدي الشحمي", "شطوان", "بن باديس", "الحصيبة", "بدر الدين", "راس الماء", "وادي السبع", "رجم دموش", "بير الحمام", "مرين", "تفاضيل", "تاغرامت", "الضاية", "مزاورو", "تيغاليمت", "تلاغ", "عين تندمين", "المرجام", "وادي تاوريرة", "تنيرة", "سيدي علي بن يوب", "بوخنيفيس", "سيدي خالد", "بني عشير", "عين قادة", "سيدي دحو الزاير", "سيدي ابراهيم", "العمارنة", "بلمختار", "المصيد", "سفيزف", "مسيد", "عين أدن", "بوجبهة البرج", "مرحوم", "سيدي شعيب", "حاسي دحو", "بن عشيبة شلية", "الطابية"],
            "23 - عنابة": ["عنابة", "البوني", "الحجار", "سيدي عمار", "برحال", "واد العنب", "تريعات", "شطايبي", "سرايدي", "العلمة", "الشرفة", "عين الباردة"],
            "24 - قالمة": ["قالمة", "قلعة بوصبع", "بومهرة أحمد", "جبالة الخميسي", "الفجوج", "بن جراح", "بلخير", "بوعاتي محمود", "هيليوبوليس", "نشماية", "الركنية", "وادي الزناتي", "عين رقادة", "عين مخلوف", "تاملوكة", "عين العربي", "عين صندل", "بوحشانة", "الخزارة", "عين بن بيضاء", "بوشقوف", "مجاز الصفاء", "وادي فراغة", "الدهوارة", "حمام دباغ", "عين حسينية", "سلاوة عنونة", "مجاز عمار", "هواري بومدين", "رأس العقبة", "وادي الشحم", "مشتة الشارف", "حمام النبائل", "المرمورة"],
            "25 - قسنطينة": ["قسنطينة", "الخروب", "عين سمارة", "أولاد رحمون", "زيغود يوسف", "بني حميدان", "ديدوش مراد", "حامة بوزيان", "عين عبيد", "ابن باديس", "مسعود بوجريو", "ابن زياد"],
            "26 - المدية": ["المدية", "ذراع السمار", "تمزقيدة", "الحمدانية", "وزرة", "البرواقية", "ربعية", "أولاد ذايد", "عين القصير", "سغوان", "مجبر", "الزبيرية", "ثلاث دوائر", "سيدي نعمان", "بوشراحيل", "خمس جوامع", "بني سليمان", "سيدي الربيع", "بوسكن", "سوق الفلاح", "القلب الكبير", "بئر بن عابد", "السدراية", "العمارية", "أولاد إبراهيم", "بعطة", "تابلاط", "العيساوية", "مزيغنة", "العزيزية", "مغراوة", "ميهوب", "شلالة العذاورة", "شنيقل", "تفراوت", "عين بوسيف", "الكاف الأخضر", "سيدي دمد", "عوينة الحجل", "أولاد هلال", "أولاد عنتر", "بوغار", "حربيل", "الشهبونية", "بوعيش", "بوغزول", "سانق", "بني مسعود", "أولاد بوعشرة", "وامري", "حناشة", "واد حربيل", "سي المحجوب", "الدرابين", "عين بوحنيفية", "بوسكن", "سيدي زهار", "جواب", "أولاد معرف", "أولاد دايد", "دراق"],
            "27 - مستغانم": ["مستغانم", "حاسي ماماش", "مزغران", "استيديا", "عين بودينار", "خير الدين", "صيادة", "صور", "عين تادلس", "السور", "وادي الخير", "سيدي بلعطار", "سيدي علي", "تازقايت", "صفصاف", "بن عبد المالك رمضان", "حجاج", "سيدي لخضر", "أولاد بوغالم", "عشعاشة", "خضرة", "نقمارية", "أولاد مع الله", "بوقيرات", "السوافلية", "سيرات", "عين سيدي شريف", "منصورة", "ماسرة", "الطواهرية", "فرناكة", "الحسيان"],
            "28 - المسيلة": ["المسيلة", "المطارفة", "أولاد ماضي", "الشلال", "معاضيد", "أولاد دراج", "الصوامع", "أولاد عدي القبالة", "حمادي", "برهوم", "الدهاهنة", "عين الخضراء", "مقرة", "بلعايبة", "عين الحجل", "سيدي هجرس", "بني يلمان", "بوطي السايح", "سيدي عيسى", "بني حميد", "سيدي عامر", "تامسة", "بوسعادة", "الهامل", "اولاد سيدي ابراهيم", "بن سرور", "محمد بوضياف", "الزرزور", "ولاد سليمان", "عين الملح", "بير الفضة", "عين الريش", "عين فارس", "سيدي امحمد", "امجدل", "مناعة", "جبل مسعد", "سليم", "الخبانة", "أولاد منصور", "تارمونت", "حمام الضلعة", "وانوغة", "أولاد عطية", "سيدي عيسى"],
            "29 - معسكر": ["معسكر", "تيزي", "فروحة", "غريس", "ماوسة", "سيدي بوسعيد", "المطمور", "عين فارس", "البرج", "تغرغارت", "وادي الأبطال", "سيدي عبد الجبار", "عين فكان", "وادي تاغية", "قوف", "القرط", "بوحنيفية", "حسين", "القعدة", "الشهاير", "سيق", "عقاز", "راس عين عميروش", "العلايمية", "بوهني", "المحمدية", "مقطع دوز", "الغمري", "سيدي عبد المومن", "فراقيق", "سجرارة", "مواليد", "الزحانة", "يعقوب", "بنيان", "الماين", "خلوية", "المنور", "زلامطة", "وادي الجمعة", "الحشم", "نسمط", "تيغنيف", "السهايلية", "سيدي قادة", "غروص", "عين افقه"],
            "30 - ورقلة": ["ورقلة", "الرويسات", "عين البيضاء", "سيدي خويلد", "حاسي بن عبد الله", "النقوسة", "البرمة", "حاسي مسعود"],
            "31 - وهران": ["وهران", "السانية", "بئر الجير", "سيدي الشحمي", "الكرمة", "المسرغين", "بوفاطيس", "تليلات", "البرية", "طفراوي", "العنصر", "عين الترك", "بوسفر", "المرسى الكبير", "أرزيو", "سيدي بن يبقى", "بطيوة", "عين البية", "عين الكرمة", "قديل", "حاسي مفسوخ", "بن فريحة", "حاسي بونيف", "حاسي بن عقبة", "السانية"],
            "32 - البيض": ["البيض", "عين العراك", "الاربط", "بريزينة", "الغاسول", "الكراكرة", "البنود", "بوعلام", "سيدي عمر", "سيدي تيفور", "ستيتن", "الرقاصة", "الشقيق", "الكاف الأحمر", "المحرة", "بوسمغون", "الخيثر", "شلالة", "توسمولين", "الأبيض سيدي الشيخ", "مكدر", "عين العراك"],
            "33 - إليزي": ["إليزي", "برج عمر إدريس", "دبداب", "إن أميناس"],
            "34 - برج بوعريريج": ["برج بوعريريج", "مجانة", "ثنية النصر", "حسناوة", "اليشير", "المنصورة", "المهير", "بن داود", "حرازة", "أولاد سيدي ابراهيم", "راس الوادي", "عين تسرة", "أولاد ابراهم", "بئر قاصد علي", "خليل", "سيدي مبارك", "تيكستار", "عين تاغروت", "برج زمورة", "تسامرت", "أولاد دحمان", "القصور", "بليمور", "الجعافرة", "الماين", "تفرق", "القلة", "برج الغدير", "تقلعيت", "غليم", "العناصر", "الحمادية", "الرابطة", "العش"],
            "35 - بومرداس": ["بومرداس", "تيجلابين", "الثنية", "بني عمران", "سوق الحد", "عمال", "بني داود", "سي مصطفى", "يسر", "شعبة العامر", "تيمزريت", "برج منايل", "زموري", "لقاطة", "جنات", "اولاد عيسى", "راس جنات", "الناصرية", "اولاد موسى", "خروبة", "بودواو", "بودواو البحري", "قورصو", "دلس", "اعفير", "بن شود", "بغلية", "سيدي داود", "تاورقة", "حمادي", "خميس الخشنة", "الاربعطاش"],
            "36 - الطارف": ["الطارف", "بوحجار", "بوقوس", "عين الكرمة", "الزيتونة", "القالة", "العيون", "رمل السوق", "الذرعان", "شبيطة مختار", "شيحاتي", "البسباس", "عصفور", "زريزر", "بن مهيدي", "بريحان", "بحيرة الطيور", "حممام بني صالح", "وادي الزيتون", "السوارخ", "عين العسل", "الزيتونة", "الشافية", "السبع"],
            "37 - تندوف": ["تندوف", "أم العسل"],
            "38 - تيسمسيلت": ["تيسمسيلت", "أولاد بسام", "خميستي", "العيون", "بوقايد", "برج بونعامة", "بني شعيب", "بني لحسن", "سيدي سليمان", "سيدي بوتشنت", "ثنية الحد", "سيدي عابد", "لرجام", "الملعب", "سيدي العنتري", "تملاحت", "الأزهرية", "الاربعاء", "عماري", "المعاصم", "سيدي بوزيد", "بني قايد"],
            "39 - الوادي": ["الوادي", "البياضة", "الرباح", "وادي العلندة", "أميه ونسة", "كوينين", "الرقيبة", "الحمراية", "قمار", "تغزوت", "الدويلة", "الزقم", "الدبيلة", "حساني عبد الكريم", "سيدي عون", "المقرن", "حاسي خليفة", "الطريفاوي", "طالب العربي", "بن قشة", "النخلة", "العقلة"],
            "40 - خنشلة": ["خنشلة", "الحامة", "بغاي", "أنسيغة", "ششار", "جلال", "بابار", "خيري واد الجمل", "أولاد رشاش", "المحمل", "قايس", "الرميلة", "تاوزيانت", "بوحمامة", "شلية", "يابوس", "مصارة", "لمصارة", "عين الطويلة", "متوسة", "طامزة"],
            "41 - سوق أهراس": ["سوق أهراس", "تاورة", "دريعة", "الزعرورية", "سدراتة", "بئر بوحوش", "خميسة", "عين سلطان", "مداوروش", "الراقوبة", "تيفاش", "الحدادة", "أولاد مومن", "الخضارة", "المراهنة", "ويلان", "سيدي فرج", "أم لعظايم", "ترقالت", "وادي الكبريت", "عين الزانة", "أولاد ادريس", "مشروحة", "لحنانشة", "سافل الويدان"],
            "42 - تيبازة": ["تيبازة", "الناظور", "سيدي عمر", "مناصر", "شرشال", "سيدي غيلاس", "حجرة النص", "سيدي سميان", "قوراية", "أغبال", "مسلمون", "حجوط", "مراد", "بورقيقة", "احمر العين", "سيدي راشد", "بوهارون", "عين تاقورايت", "خميستي", "بواسماعيل", "القليعة", "الشعيبة", "فوكة", "الدواودة", "سيدي اعمر", "بني ميلك", "الداموس", "الارحات", "الناظور"],
            "43 - ميلة": ["ميلة", "عين التين", "سيدي خليفة", "سيدي مروان", "الشيقارة", "القرارم قوقة", "حمالة", "شلغوم العيد", "عين الملوك", "وادي العثمانية", "تاجنانت", "بن يحيى عبد الرحمن", "أولاد خلوف", "تلاغمة", "وادي سقان", "المشيرة", "مينار زرزة", "تسالة لمطاعي", "الرواشد", "تيبرقنت", "عين البيضاء احريش", "العياضي برباس", "فرجيوة", "يحيى بني قشة", "بوحاتم", "دراس البيضاء", "أحمد راشدي", "عين مسعود", "زغاية", "ترعي باينان", "عميرة أراس", "تسدان حدادة"],
            "44 - عين الدفلى": ["عين الدفلى", "مخاطرية", "الحمام ريغة", "بوراشد", "بومدفع", "عين البنيان", "خميس مليانة", "سيدي لخضر", "جلقيدة", "عين السلطان", "عين الأشياخ", "واد جمعة", "جليدة", "جمعة أولاد الشيخ", "بئر ولد خليفة", "العطاف", "العبادية", "تاشتة زقاغة", "عين بويحيى", "الماين", "زدين", "الروينة", "الخربة", "عامرة", "الحسنية", "بطحية", "مليانة", "بن علال", "سيدي أحمد بن علي", "واد الشرفاء", "بربوش", "طارق بن زياد", "عريب", "المخاطرية", "بلعاص"],
            "45 - النعامة": ["النعامة", "المشرية", "عين بن خليل", "البيوض", "عسلة", "مغرار", "جنين بورزق", "تيوت", "سفيسيفة", "القصدير", "مكمن بن عمار", "عين الصفراء"],
            "46 - عين تموشنت": ["عين تموشنت", "سيدي بن عدة", "شنتوف", "حمام بوحجر", "وادي الصباح", "عين الأربعاء", "تمزورة", "سيدي بومدين", "عين الكيحل", "عقب الليل", "أغلال", "تارقة", "المالح", "شعبية", "المساعيد", "بني صاف", "سيدي صافي", "الأمير عبد القادر", "ولهاصة", "أولاد بوجمعة", "العامرية", "بوزجار", "حاسي الغلة", "أولاد الكيحل", "وادي برقش", "السيغة", "عين الطلبة"],
            "47 - غرداية": ["غرداية", "ضاية بن ضحوة", "بونورة", "العطف", "زلفانة", "القرارة", "بريان", "متليلي", "سبسب", "المنصورة"],
            "48 - غليزان": ["غليزان", "بن داود", "يلل", "سيدي خطاب", "عين الرحمة", "القلعة", "مطمر", "بلعسل", "سيدي سعادة", "زمورة", "بني درقن", "منداس", "وادي السلام", "سيدي لزرق", "عمي موسى", "الولجة", "أولاد يعيش", "حد الشكالة", "وادي ارهيو", "واريزان", "لحلاف", "جديوية", "حمري", "أولاد سيدي الميهوب", "مازونة", "القطار", "سيدي امحمد بن علي", "مديونة", "بني زنطيس", "مرجة سيدي عابد", "واد الجمعة", "الحمادنة", "عين طارق", "الرمكة", "سوق الحد", "دار بن عبد الله", "بني لنت"],
            "49 - تيميمون": ["تيميمون", "أولاد سعيد", "أوقروت", "دلدول", "شروين", "طلمين", "قصر قدور", "تينركوك", "كوسام", "أولاد عيسى"],
            "50 - برج باجي مختار": ["برج باجي مختار", "تيمياوين"],
            "51 - أولاد جلال": ["أولاد جلال", "سيدي خالد", "راس الميعاد", "البسباس", "الشعيبة", "الدوسن"],
            "52 - بني عباس": ["بني عباس", "تامترت", "إقلي", "الواتة", "بني يخلف", "كرزاز", "تيمودي", "قصابي", "أولاد خضير", "الوغدة"],
            "53 - عين صالح": ["عين صالح", "فقارة الزوى", "إينغر"],
            "54 - عين قزام": ["عين قزام", "تين زاوتين"],
            "55 - تقرت": ["تقرت", "النزلة", "تبسبست", "الزاوية العابدية", "تماسين", "بليدة عمر", "المقارين", "المنقر", "الطيبات", "بن ناصر", "الحجيرة", "العالية", "سيدي سليمان"],
            "56 - جانت": ["جانت", "برج الحواس"],
            "57 - المغير": ["المغير", "أم الطيور", "جامعة", "مرارة", "تندلة", "سيدي خليل", "سيدي عمران", "السطيل"],
            "58 - المنيعة": ["المنيعة", "حاسي القارة", "حاسي الفحل"]
        };

        const CATEGORIES = ['الكل', 'هواتف', 'لابتوب', 'ساعات', 'إكسسوارات', 'ملابس', 'منزل'];
        const WILAYAS_LIST = Object.keys(ALGERIA_DATA);

        // ... (باقي الكود والمكونات كما هي) ...

        const Icon = ({ name, size = 24, className = "", filled = false }) => {
            const icons = {
                Home: <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />,
                Grid: <path d="M3 3h7v7H3zM14 3h7v7h-7zM14 14h7v7h-7zM3 14h7v7H3z" />,
                Heart: <path fill={filled ? "currentColor" : "none"} d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" />,
                ShoppingBag: <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4H6zM3 6h18M16 10a4 4 0 0 0-8 0" />,
                Search: <circle cx="11" cy="11" r="8" />,
                ChevronRight: <path d="M9 18l6-6-6-6" />,
                Star: <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" fill="currentColor"/>,
                Plus: <path d="M12 5v14M5 12h14" />,
                Minus: <path d="M5 12h14" />,
                Trash: <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />,
                Check: <path d="M20 6L9 17l-5-5" />
            };
            return <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{icons[name]}</svg>;
        };

        const SkeletonCard = () => (
            <div className="bg-white p-3 rounded-2xl shadow-sm border border-gray-100 animate-pulse">
                <div className="bg-gray-200 h-40 rounded-xl mb-3 w-full"></div>
                <div className="h-4 bg-gray-200 rounded w-3/4 mb-2"></div>
                <div className="h-3 bg-gray-200 rounded w-1/2 mb-4"></div>
            </div>
        );

        const App = () => {
            const [products, setProducts] = useState([]);
            const [loading, setLoading] = useState(true);
            const [view, setView] = useState('home');
            const [cart, setCart] = useState(() => JSON.parse(localStorage.getItem('dz_cart')) || []);
            const [wishlist, setWishlist] = useState(() => JSON.parse(localStorage.getItem('dz_wishlist')) || []);
            const [selectedProduct, setSelectedProduct] = useState(null);
            const [search, setSearch] = useState('');
            const [category, setCategory] = useState('الكل');
            
            const [formData, setFormData] = useState({ name: '', phone: '', wilaya: WILAYAS_LIST[0], commune: '', address: '' });
            const [availableCommunes, setAvailableCommunes] = useState(ALGERIA_DATA[WILAYAS_LIST[0]]);

            useEffect(() => localStorage.setItem('dz_cart', JSON.stringify(cart)), [cart]);
            useEffect(() => localStorage.setItem('dz_wishlist', JSON.stringify(wishlist)), [wishlist]);

            useEffect(() => {
                const fetchData = async () => {
                    try {
                        const res = await fetch(`${GAS_API_URL}?sheet=Products&t=${Date.now()}`);
                        if (!res.ok) throw new Error("فشل الاتصال");
                        const data = await res.json();
                        setProducts(data.map(p => ({ ...p, id: Number(p.id), price: Number(p.price), rating: Number(p.rating || 5), images: p.images ? String(p.images).split('|') : ["https://placehold.co/400"], isNew: String(p.isNew) === 'true' })).filter(p => p.id));
                    } catch (error) { console.error(error); } finally { setLoading(false); }
                };
                fetchData();
            }, []);

            const handleWilayaChange = (e) => {
                const selectedWilaya = e.target.value;
                setFormData({ ...formData, wilaya: selectedWilaya, commune: '' });
                setAvailableCommunes(ALGERIA_DATA[selectedWilaya] || []);
            };

            const addToCart = (p) => setCart(prev => {
                const exists = prev.find(i => i.id === p.id);
                return exists ? prev.map(i => i.id === p.id ? { ...i, qty: i.qty + 1 } : i) : [...prev, { ...p, qty: 1 }];
            });

            const placeOrder = async (e) => {
                e.preventDefault();
                setLoading(true);
                try {
                    await fetch(GAS_API_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'text/plain' }, 
                        body: JSON.stringify({
                            action: 'ADD_ORDER',
                            data: {
                                id: Date.now(),
                                date: new Date().toLocaleDateString('en-GB'),
                                total: cart.reduce((a,c) => a + c.price * c.qty, 0) + 500,
                                status: 'pending',
                                customerJson: JSON.stringify(formData),
                                itemsJson: JSON.stringify(cart.map(i => ({ id: i.id, name: i.name, qty: i.qty })))
                            }
                        })
                    });
                    setCart([]); setView('success');
                } catch { setCart([]); setView('success'); } finally { setLoading(false); }
            };

            const filteredProducts = products.filter(p => (category === 'الكل' || p.category === category) && (p.name && p.name.toLowerCase().includes(search.toLowerCase())));

            const BottomNav = () => (
                <div className="fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur border-t px-6 py-2 flex justify-between items-center md:hidden z-50">
                    <button onClick={() => setView('home')} className={`flex flex-col items-center gap-1 ${view === 'home' ? 'text-primary' : 'text-gray-400'}`}><Icon name="Home" /><span className="text-[10px] font-bold">الرئيسية</span></button>
                    <button onClick={() => setView('wishlist')} className={`flex flex-col items-center gap-1 ${view === 'wishlist' ? 'text-primary' : 'text-gray-400'}`}><Icon name="Heart" filled={view === 'wishlist'} /><span className="text-[10px] font-bold">المفضلة</span></button>
                    <div className="relative -top-5"><button onClick={() => setView('cart')} className="bg-primary text-white p-4 rounded-full shadow-lg"><Icon name="ShoppingBag" />{cart.length > 0 && <span className="absolute top-0 right-0 bg-red-500 text-white text-xs font-bold w-5 h-5 rounded-full flex items-center justify-center border-2 border-white">{cart.reduce((a,c)=>a+c.qty,0)}</span>}</button></div>
                    <button onClick={() => setView('cart')} className={`flex flex-col items-center gap-1 ${view === 'cart' ? 'text-primary' : 'text-gray-400'}`}><span className="text-[10px] font-bold mt-6">السلة</span></button>
                    <button className="flex flex-col items-center gap-1 text-gray-400 opacity-50"><Icon name="Grid" /><span className="text-[10px] font-bold">المزيد</span></button>
                </div>
            );

            return (
                <div className="min-h-screen bg-[#f8fafc]">
                    <header className="sticky top-0 z-40 glass px-4 py-3 flex justify-between items-center">
                        <div className="flex items-center gap-2 cursor-pointer" onClick={() => setView('home')}>
                            <div className="w-9 h-9 bg-primary rounded-xl flex items-center justify-center text-white font-black text-lg shadow-lg">DZ</div>
                            <h1 className="font-black text-xl tracking-tight text-dark">Shop</h1>
                        </div>
                        <button onClick={() => setView('cart')} className="md:hidden relative bg-gray-100 p-2 rounded-full"><Icon name="ShoppingBag" size={20} />{cart.length > 0 && <span className="absolute -top-1 -right-1 bg-red-500 text-white text-[10px] w-4 h-4 rounded-full flex items-center justify-center">{cart.length}</span>}</button>
                    </header>
                    <main className="container mx-auto px-4 py-6 max-w-6xl animate-fade-in pb-20">
                        {view === 'home' && (
                            <>
                                <div className="sticky top-[65px] z-30 bg-[#f8fafc]/95 backdrop-blur py-2 mb-4 space-y-3">
                                    <div className="relative"><input type="text" placeholder="ابحث..." className="w-full bg-white border-none shadow-sm rounded-2xl py-3 px-10 text-sm focus:ring-2 focus:ring-primary outline-none" value={search} onChange={e => setSearch(e.target.value)} /><div className="absolute right-3 top-3 text-gray-400"><Icon name="Search" size={20} /></div></div>
                                    <div className="flex gap-2 overflow-x-auto no-scrollbar pb-1">{CATEGORIES.map(cat => (<button key={cat} onClick={() => setCategory(cat)} className={`whitespace-nowrap px-5 py-2 rounded-full text-sm font-bold transition-all ${category === cat ? 'bg-dark text-white shadow-lg' : 'bg-white text-gray-500 border border-gray-100'}`}>{cat}</button>))}</div>
                                </div>
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                    {loading ? Array(4).fill(0).map((_, i) => <SkeletonCard key={i} />) : 
                                     filteredProducts.map(p => (
                                        <div key={p.id} className="bg-white rounded-2xl p-3 shadow-sm border border-gray-100 hover:shadow-xl transition-all cursor-pointer" onClick={() => {setSelectedProduct(p); setView('product');}}>
                                            <img src={p.images[0]} className="w-full aspect-square object-cover rounded-xl mb-3 bg-gray-100" onError={(e)=>e.target.src="https://placehold.co/400"} />
                                            <h3 className="font-bold text-sm truncate mb-1">{p.name}</h3>
                                            <div className="flex justify-between items-end"><p className="text-primary font-black">{p.price.toLocaleString()} د.ج</p><button onClick={(e) => {e.stopPropagation(); addToCart(p);}} className="bg-dark text-white p-2 rounded-xl"><Icon name="Plus" size={16} /></button></div>
                                        </div>
                                    ))}
                                </div>
                            </>
                        )}

                        {view === 'product' && selectedProduct && (
                            <div className="animate-slide-up">
                                <button onClick={() => setView('home')} className="mb-4 flex items-center gap-2 text-gray-500 font-bold"><Icon name="ChevronRight" /> رجوع</button>
                                <div className="bg-white rounded-3xl shadow-xl overflow-hidden p-4">
                                    <img src={selectedProduct.images[0]} className="w-full h-64 object-contain mb-4" onError={(e)=>e.target.src="https://placehold.co/400"} />
                                    <h1 className="text-2xl font-black mb-2">{selectedProduct.name}</h1>
                                    <p className="text-gray-500 mb-6">{selectedProduct.description || "لا يوجد وصف."}</p>
                                    <div className="flex gap-3"><button onClick={() => addToCart(selectedProduct)} className="flex-1 bg-gray-100 py-3 rounded-xl font-bold">إضافة للسلة</button><button onClick={() => {addToCart(selectedProduct); setView('checkout')}} className="flex-1 bg-dark text-white py-3 rounded-xl font-bold">شراء الآن</button></div>
                                </div>
                            </div>
                        )}

                        {view === 'cart' && (
                            <div className="animate-slide-up">
                                <h2 className="text-2xl font-black mb-6">السلة</h2>
                                {cart.map(item => (
                                    <div key={item.id} className="bg-white p-4 rounded-2xl shadow-sm mb-3 flex gap-4 items-center">
                                        <img src={item.images[0]} className="w-16 h-16 rounded-xl object-cover" onError={(e)=>e.target.src="https://placehold.co/400"} />
                                        <div className="flex-1"><h3 className="font-bold">{item.name}</h3><p className="text-primary font-bold">{item.price} د.ج</p></div>
                                        <div className="font-bold">x{item.qty}</div>
                                    </div>
                                ))}
                                {cart.length > 0 && <button onClick={() => setView('checkout')} className="w-full bg-dark text-white py-4 rounded-xl font-bold mt-4 shadow-lg">متابعة للدفع ({(cart.reduce((a,c)=>a+c.price*c.qty,0) + 500).toLocaleString()} د.ج)</button>}
                            </div>
                        )}

                        {view === 'checkout' && (
                            <div className="animate-slide-up max-w-lg mx-auto">
                                <button onClick={() => setView('cart')} className="mb-4 flex items-center gap-2 text-gray-500 font-bold"><Icon name="ChevronRight" /> العودة</button>
                                <div className="bg-white p-6 rounded-3xl shadow-xl">
                                    <h2 className="text-xl font-black mb-4">معلومات التوصيل</h2>
                                    <form onSubmit={placeOrder} className="space-y-4">
                                        <input required placeholder="الاسم الكامل" className="w-full bg-gray-50 border rounded-xl p-3 outline-none" value={formData.name} onChange={e => setFormData({...formData, name: e.target.value})} />
                                        <input required type="tel" placeholder="رقم الهاتف" className="w-full bg-gray-50 border rounded-xl p-3 outline-none" value={formData.phone} onChange={e => setFormData({...formData, phone: e.target.value})} />
                                        <div className="grid grid-cols-2 gap-4">
                                            <div>
                                                <label className="text-xs font-bold text-gray-500 block mb-1">الولاية</label>
                                                <select className="w-full bg-gray-50 border rounded-xl p-3 outline-none text-sm" value={formData.wilaya} onChange={handleWilayaChange}>
                                                    {WILAYAS_LIST.map(w => <option key={w} value={w}>{w}</option>)}
                                                </select>
                                            </div>
                                            <div>
                                                <label className="text-xs font-bold text-gray-500 block mb-1">البلدية</label>
                                                <select required className="w-full bg-gray-50 border rounded-xl p-3 outline-none text-sm" value={formData.commune} onChange={e => setFormData({...formData, commune: e.target.value})}>
                                                    <option value="">اختر البلدية</option>
                                                    {availableCommunes.map(c => <option key={c} value={c}>{c}</option>)}
                                                </select>
                                            </div>
                                        </div>
                                        <input required placeholder="العنوان (الحي/الشارع)" className="w-full bg-gray-50 border rounded-xl p-3 outline-none" value={formData.address} onChange={e => setFormData({...formData, address: e.target.value})} />
                                        <button disabled={loading} className="w-full bg-primary text-white py-4 rounded-xl font-bold shadow-lg mt-4">{loading ? 'جاري الإرسال...' : 'تأكيد الطلب'}</button>
                                    </form>
                                </div>
                            </div>
                        )}
                        
                        {view === 'success' && (
                            <div className="flex flex-col items-center justify-center py-20 animate-slide-up text-center">
                                <div className="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center text-green-600 mb-4"><Icon name="Check" size={40} /></div>
                                <h2 className="text-2xl font-black mb-2">تم الطلب بنجاح!</h2>
                                <button onClick={() => setView('home')} className="mt-6 text-primary font-bold">العودة للرئيسية</button>
                            </div>
                        )}
                    </main>
                    <BottomNav />
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
